import streamlit as st
import pandas as pd
import os


#from google.oauth2.credentials import Credentials
#from googleapiclient.discovery import build
#from googleapiclient.errors import HttpError

# 環境変数からGoogle Drive APIの認証情報を取得
#def authenticate_gdrive():
    # 環境変数を設定している場合のみ読み込む
    #creds = Credentials.from_service_account_file(
        #os.getenv("GOOGLE_APPLICATION_CREDENTIALS"),
        #scopes=["https://www.googleapis.com/auth/drive"]
   # )
    #return build("drive", "v3", credentials=creds)

# Google Driveのファイルリンクを取得する関数
#def get_file_link(file_id):
    #return f"https://drive.google.com/uc?id={file_id}"

# Google Driveの画像を取得して表示
#file_id1 = "1tQMqjPNYvQMwQo1GIXJSeJOs4NtgrBHR"  # 画像1のファイルID
#file_id2 = "14S9vje6JPIkqcUTwW4gD_tmJq2tBTmVt"  # 画像2のファイルID

#image_url1 = get_file_link(file_id1)
#image_url2 = get_file_link(file_id2)

#st.image(image_url1, caption="画像1: 衣服の着脱練習", use_column_width=True)
#st.image(image_url2, caption="画像2: その他の活動", use_column_width=True)



# フィードバック保存用のExcelファイル
feedback_dir = r"C:\Users\taka\OneDrive\デスクトップ\GitHub\special_education_app"
feedback_file = os.path.join(feedback_dir, "feedback.xlsx")

# ディレクトリが存在しない場合、作成する
if not os.path.exists(feedback_dir):  # feedback_dir を確認する
    os.makedirs(feedback_dir)

# Excelファイルが存在しない場合、作成する
if not os.path.exists(feedback_file):
    pd.DataFrame(columns=["カテゴリー", "項目", "追加内容"]).to_excel(feedback_file, index=False, engine='openpyxl')

# 初期データの読み込み
if os.path.exists(feedback_file):
    feedback_data = pd.read_excel(feedback_file, engine='openpyxl')
else:
    feedback_data = pd.DataFrame(columns=["カテゴリー", "項目", "追加内容"])


# アプリの基本構造
st.title("🌟 自立活動の参考指導 🌟")

# メニュー選択
menu = st.sidebar.selectbox("メニューを選択してください", ["指導支援内容", "フィードバック追加", "フィードバック集計と削除"])



# メニューによって表示を制御
if menu not in ["フィードバック追加", "フィードバック集計と削除"]:
    # 'フィードバック追加' または 'フィードバック集計と削除' 以外のメニューが選ばれた場合にのみ表示
    
    guidance_data = []  # 指導データの実際の内容
    st.write(guidance_data)
# メニューごとの処理
if menu == "フィードバック追加":
    st.subheader("📝 フィードバック追加")
    
    feedback_category = st.selectbox("カテゴリーを選択:", ["日常生活における実態", "障害の種類"])
    feedback_subcategory = st.selectbox("項目を選択:", ["身辺自立が未熟な生徒","コミュニケーションが苦手な生徒","社会生活スキルが不足している生徒","時間や順序の理解が苦手な生徒","運動能力や感覚に偏りがある生徒","情緒が不安定な生徒","集団活動への参加が難しい生徒", "聴覚障害","視覚障害","ダウン症","自閉スペクトラム症（ASD）","注意・欠如・多動性障害（ADHD）","自閉スペクトラム症（ASD）","学習障害（LD）","発達性協調運動障害（DCD）","四肢・体幹機能障害"])
    feedback_content = st.text_area("追加するフィードバックを入力してください:")

    if st.button("フィードバックを保存"):
        if feedback_content:
            # 新しいフィードバックのデータフレーム
            new_feedback = pd.DataFrame([{
                "カテゴリー": feedback_category,
                "項目": feedback_subcategory,
                "追加内容": feedback_content
            }])
            feedback_data = pd.concat([feedback_data, new_feedback], ignore_index=True)
            try:
                # フィードバックの保存
                feedback_data.to_excel(feedback_file, index=False, engine='openpyxl')
                st.success("フィードバックが保存されました！")
                st.text(f"保存先: {feedback_file}")
            except Exception as e:
                st.error(f"フィードバックの保存中にエラーが発生しました: {e}")
        else:
            st.warning("フィードバック内容を入力してください。")

if menu == "指導支援内容":
    st.subheader("📚 指導支援内容の参照")
    st.text("1から順番に選択して下さい")



elif menu == "フィードバック集計と削除":
    st.subheader("📊 フィードバック集計と削除")
    if feedback_data.empty:
        st.info("現在、保存されているフィードバックはありません。")
    else:
        for i, row in feedback_data.iterrows():
            st.write(f"{i + 1}. 【カテゴリー】{row['カテゴリー']} / 【項目】{row['項目']} / 【内容】{row['追加内容']}")
            if st.checkbox(f"削除: {i + 1}", key=f"delete_{i}"):
                feedback_data.drop(index=i, inplace=True)
        
        if st.button("選択したフィードバックを削除"):
            feedback_data = feedback_data[~feedback_data.index.isin([i for i, row in feedback_data.iterrows() if st.checkbox(f"削除: {i + 1}", key=f"delete_{i}")])]
            feedback_data.reset_index(drop=True, inplace=True)
            feedback_data.to_excel(feedback_file, index=False, engine='openpyxl')  # 保存
            st.success("選択したフィードバックを削除しました！")

# ディレクトリが存在しない場合、作成する
if not os.path.exists(feedback_dir):
    os.makedirs(feedback_dir)  # この行で保存先ディレクトリを作成



    
# 指導データ
guidance_data = {
    "日常生活における実態": {
        "身辺自立が未熟な生徒": {
            "衣服の着脱練習": [
                         "具体的教材の導入: 実際のボタン付きシャツやファスナーを取り付けたパネル教材を使い、繰り返し練習する。","段階的指導: まずは「袖に手を通す」「ボタンをつまむ」など簡単なステップに分け、一つずつ練習を進める。","視覚支援の活用: 着替えの順序をイラストや写真で示し、見通しを持たせる。","実践的練習: 毎朝の登校後や体育の後など、実際の生活場面での練習を取り入れる。"
                         #,st.image(image_url1, caption="画像1: 衣服の着脱練習", use_column_width=True),
              ],
            "食事の練習": [
                          "器具選び: 太めで握りやすいスプーンやフォークを使い、持ち方や使い方を教える。","模倣の練習: 教員がゆっくりと動作を見せ、生徒が真似をする形でスプーンの持ち方や口への運び方を学ぶ。","具体的課題設定: 小さな一口サイズの食べ物から始め、達成しやすい目標を設定する。","片付けの練習: 食事後にお皿を所定の場所に運ぶ練習を取り入れる。開始時は手を添えてサポートし、徐々に自立を促す。"
              ],
            "感覚統合活動": [ 
                         "感覚に配慮した布選び: 初めは柔らかく生徒が触りやすい素材を使い、徐々に異なる感触の素材に慣れさせる。","遊びを取り入れた活動: 感触遊び（触覚用スライム、ビーズのプール）や、冷たい・温かい感覚を体験するゲームを実施する。","成功体験を重視: 生徒が触れられる素材や温度に合わせて成功しやすい体験を積ませ、自信を持たせる。 異なる素材の布や玩具を触る活動を取り入れ、感覚過敏を軽減。"
              ],
        },
        "コミュニケーションが苦手な生徒": {
            "ピクトグラムや絵カードの活用 (自分の意思や要望をカードで表現する練習。)": [
                         "個別にカスタマイズしたカード作成: 生徒の日常生活や好きな物に基づいて、実際の写真や絵を用意。","ルールの反復練習: 例えば、「飲み物が欲しいときは飲み物のカードを見せる」といった場面ごとのルールを繰り返し指導。","応用的な使い方: カードを複数使って「ジュースが欲しい」「トイレに行きたい」など具体的なフレーズを伝えられるようにする。また、依頼する教員の写真カードと要求の絵・写真カードを同時に使って伝えられるようにする。（PECS、コミュニケーションボード）"
              ],
            "リトミック (音楽に合わせて動き、教師や仲間と簡単なやり取りを行う。)": [
                         "個人から集団へ: 初めは教員と1対1で音楽に合わせた動きを練習し、慣れたら徐々に他の生徒と関わる活動を増やす。","簡単な役割設定: 「先生の動きを真似する」「次に自分が音を鳴らす」など、小さな役割を与え、成功体験を積ませる。","感情表現の促進: 音楽のテンポやリズムに合わせ、「嬉しい」「悲しい」など感情を表す動きを取り入れる。"
              ],
            "ジェスチャー練習 (「ありがとう」「おいしい」など簡単な表現を学ぶ活動。)": [
                         "日常生活での活用: 実際の場面（給食時に「ありがとう」や、おかわりの際に「もっと」など）でジェスチャーを自然に使う練習を行う。","視覚教材を活用: ジェスチャーの動きを示すイラストを用意し、動き方を理解しやすくする。","ゲーム形式で学習: 「これ何のジェスチャー？」とクイズ形式で楽しく取り組む。"
              ],
        },
        "社会生活スキルが不足している生徒": {
            "買い物の練習 (模擬店舗でお金を払う練習や、お釣りを受け取る活動。)": [
                        "模擬店舗の設定: 実際にレジや商品棚を模した教室内環境を作り、お金の支払い方や商品選びを練習。","具体的な役割分担: 生徒が「お客さん役」「店員役」を交互に体験し、それぞれの立場のやり取りを学ぶ。","数の理解を強化: 商品価格がわかりやすいよう、価格シールに大きな数字を記載。「リンゴ2つで100円」といった足し算の練習も含める。"
              ],
            "交通機関の利用練習": [
                        "ステップ練習: (1) 切符を買う→(2) 改札を通る→(3) バス停やホームで待つ、など行動を分けて練習。","実際の利用体験: 教員が付き添い、学校周辺でバスや電車を実際に使う。降車のタイミングを知らせる練習も行う。","シミュレーション教材の活用: 動画や写真で「バスに乗る流れ」を事前に学び、実際の場面に活かす。"
              ],
            "挨拶や簡単な会話の練習": [
                        "場面設定型練習: 「先生に挨拶」「友達にお願いする」など、状況を再現して練習。","具体的なフレーズ練習: 例として「これをください」「ありがとう」「すみません」など基本的な表現を繰り返し指導。","視覚的サポート: 挨拶や会話の場面を示す絵カードを見せ、次に行う動作をイメージさせる。"
              ],
        },
        "時間や順序の理解が苦手な生徒": {
            "時計の読み方練習 (アナログ時計を用いて「○時○分」を理解する活動。)": [ 
                        "視覚と触覚を活用した時計教材: 時計の針を動かせる教材を用意し、「短い針が3、長い針が12だから3時」といった具体的な説明を繰り返す。","デジタル時計とアナログ時計の一致練習: 同時にデジタル時計を見せて、対応関係を確認。例えば、「3:30と時計の針はこうなる」と視覚的に理解させる。","ゲーム形式で練習: 「10時に針を合わせてみて」といった指示で実際に針を動かすゲームを取り入れる。正解したら褒めることで動機づけする。"
              ],
            "視覚的スケジュール(ピクトグラムや写真を用いた1日の流れを確認する練習。)": [  
                        "個別化したスケジュール表の作成: 生徒の活動に応じたピクトグラムや写真を並べ、「朝の会」「休憩」「掃除」など活動ごとに分かりやすく整理。","実物の確認とリンク: 活動前に実際の物（掃除道具や給食トレーなど）を見せ、スケジュール上の画像と結びつける。","完成表での達成感を促進: 終わった活動のピクトグラムを「完了」ボックスに移動することで進行状況を可視化。"
              ],
            "タイマーの活用 (「この活動は5分」「次は10分後」といった時間感覚を養うための練習。)": [ 
                        "視覚タイマーを使用: 時間が減る様子が視覚的にわかるタイマー（例: Time Timer）を使い、「赤い部分がなくなったら次の活動」と説明。","切り替え練習の導入: タイマーが鳴った後にすぐ切り替える練習を小さなタスク（「ボールを箱に入れる」「机に座る」など）で繰り返す。","活動前の見通し提示: 「この活動は3分間だけ」など時間を事前に伝えることで、安心感と集中力を高める。"
              ],
        },
        "運動能力や感覚に偏りがある生徒": {
            "感覚統合運動 (平均台を使ったバランス練習や、ボール遊びを通じた体幹の強化。)": [ 
                        "簡易なバランス練習: 平均台の幅を調整し、初めは広めに設定。バランスを取りやすい状態で練習を始める。","複合的な活動: ボールを渡す→次に平均台を渡る、といった複数の動きを組み合わせることで運動能力を向上。","成功の楽しさを強調: 小さな成功を積み重ねることで運動への抵抗感を軽減する。"
              ],
            "リトミック (音楽に合わせて手足を動かし、動作のリズム感や協調性を高める)": [
                        "動作の選択肢を広げる: 簡単な手拍子からジャンプや回転といった動作へ徐々に難易度を上げる。","音楽の多様化: 生徒が興味を持つ曲を使い、音楽との親和性を高める。","褒める機会を増やす: できた動作に対し、すぐに「素晴らしい！」といったフィードバックを行い自信を促す。"
              ],
            "簡単な体操( 短時間でできるストレッチや全身運動で体力をつける。)": [
                         "遊びを取り入れる: 体操の動作を「動物ごっこ（うさぎ跳び、クマ歩き）」として楽しめる形で導入。","短時間のサイクル: 最初は1分程度の体操から始め、徐々に時間を延ばす。","反復学習: 毎日同じ体操を繰り返し行い、動作のパターンを身につけさせる。"
              ],
        },
        "情緒が不安定な生徒 (静かな音楽を聴きながらの深呼吸や簡単なストレッチ。)": {
            "リラクゼーション活動": [
                         "段階的深呼吸練習: 「鼻から4秒吸って、口から6秒吐く」といったカウント付きの深呼吸を繰り返し指導。タイマーやメトロノームを使うとリズムをつかみやすい。","環境調整: リラクゼーションの場は光を弱め、柔らかいクッションやブランケットを用意して安心感を与える。","五感を使ったリラックス: 柔らかいボールを握る、香り付きのオイルやハンドクリームを使うなど、触覚や嗅覚を取り入れた活動を組み込む。"
              ],
            "自己表現活動:  絵や音楽を使い、自分の感情を自由に表現する練習。": [
                         "絵画や造形活動: 「好きな色で今日の気分を描いてみよう」など自由なテーマを与える。興味を広げるために粘土やクラフト素材も用意。","音楽を用いた表現: 太鼓やカスタネットなどの楽器を使い、強い音や静かな音で感情を表現する練習を行う。","感情カードの活用: 表情や気分を示したカード（例: 怒り、悲しみ、喜び）を使い、どのカードが自分の気持ちに近いか選ばせる。"
              ],
            "感情コントロール練習:  「怒ったら深呼吸を3回」「悲しいときは絵で表す」などの具体的な方法を教える。": [
                         "具体的な手順の提示: 「怒ったときは手をグーにして3秒間握る→パッと開く」を繰り返す。緊張をほぐすための身体的な動作を教える。","感情日記の導入: 簡単な絵やシールを使い、1日の中で気持ちがどう変化したか記録する習慣をつける。","モデルロールプレイ: 教員が感情をコントロールする場面を演じ、生徒がそれを真似る練習を行う。"
              ],
        },
         "集団活動への参加が難しい生徒 (ルールが明確で、短時間で終わる集団ゲーム（例: ボール渡し、手遊び歌）。": {
            "簡単なゲーム活動": [
                         "ルールの視覚化: ゲームの手順やルールをピクトグラムや簡単な文章で示す。「まず手を挙げる→次にボールを渡す」など具体的に説明。","短時間で終わるゲーム: ボールを隣に渡すだけの「リレー遊び」や「手を叩いて次の人に合図を送る」など、単純な動作で完結するゲームを選ぶ。","成功体験を積ませる: できたことを即座に褒める。「○○さんが次の人にボールを渡せたね！」と具体的に声をかける。"
               ],
            "役割分担の練習 (「今日はあなたが○○をする役」と明確に役割を設定した活動。)": [
                         "簡単で明確な役割設定: 「ボールを渡す役」「時間を測る役」など、個々の役割が明確な活動を選ぶ。","役割を変更する練習: 同じ活動内で役割を交代させる。「次は○○さんがタイマーを押すね」と練習を通して柔軟性を高める。","役割カードの利用: 役割をイラストや写真で提示し、視覚的にわかりやすく伝える。"
               ],
            "少人数からの集団練習 (2～3人の小グループから始め、徐々に大人数に移行。)": [
                         "特定の友達とのペア活動: 信頼関係がある生徒とペアを組み、少人数での活動に慣れる。","「待つ」練習: 少人数グループ内で順番を待つ練習を取り入れ、焦らず参加できる環境を作る。","グループの人数を段階的に増やす: 2人→3人→5人と徐々に人数を増やし、活動のスケールに慣れさせる。"
               ],
         },
   },    
    "障害の種類": {
        "聴覚障害": {
            "コミュニケーション支援": [
                "title": "手話の練習: 手話を使って、自己紹介や日常会話を学ぶ。", # type: ignore
                    "details": [
                        "場面設定を重視した練習: 食事の場面で「ごはん」「おかわり」などの手話を学ぶ。学校や家で頻繁に使うフレーズから始める。",
                        "ゲーム形式の練習: 手話でしりとりや「〇〇はどこ？」のようなクイズを行い、楽しく習得できる環境を提供する。",
                        "家族との連携: 家庭でも手話を使えるよう、保護者向けのワークショップを実施し、共通の表現方法を増やす。",
                "ジェスチャー活用: 視覚的な動きで意思を伝える練習（例: 「飲みたい」「行きたい」など）。",
                "指文字練習: 手話に加え、指文字を活用する場面を設定。",
                "タブレットでのコミュニケーション: 音声入力から文字表示を活用したアプリでの意思疎通。"],
            ],
            "視覚的支援": [
                "ピクトグラムや文字カードの活用: 1日の流れや指示内容を視覚的に表示。",
                "サインカード作成: 「待つ」「見る」「静かに」などの指示を表すカードを使う。",
                "ICTを活用: 図や表、動画、アニメーションなどをより多く提示する。",
            ],
            "集団活動への参加": [
                "音ではなく光を使った指示: ランプやフラッシュライトを使い、スタートや終了を知らせる。",
                "ペアでの活動: 聞こえる生徒とペアを組み、互いに補い合う練習。",
            ],
        },
        "視覚障害": {
            "空間認識の訓練": [
                "白杖の使い方練習: 安全に歩行するための基本操作を学ぶ。",
                "誘導ロープの使用: ロープを手に持ちながら教室や廊下を移動する練習。",
                "点字ブロックの理解: 点字ブロックの種類や意味を実際に歩いて確認。",
            ],
            "感覚を活用した学習": [
                "点字の練習: 自分の名前や簡単な単語を点字で学ぶ。",
                "触覚教材の利用: 凸凹で文字や図形を感じ取れる教材を使った学習。",
                "音声教材の活用: 録音教材や音声ガイドを利用して学ぶ。",
            ],
            "生活スキルの向上":[
                          "身辺自立活動: ボタンやファスナーを触覚で確認しながら衣服を着脱。"
                          "台所の基本操作: 安全に調理器具を使う練習（例: 包丁の持ち方や火加減の確認）。"
            ],
             "ICTを活用した支援":[
                          "音声読み上げソフト: タブレットやパソコンの音声機能を使って学習。"
                          "拡大読書器の利用: 弱視の場合は文字や画像を拡大して見る訓練。"
             ],
        },
         "ダウン症": {
            "コミュニケーションスキルの向上": [
                "ゆっくりした発話練習: 正確に言葉を発する練習（例: 音読や短い歌）。",
                "簡単な会話の練習: 「こんにちは」「これをください」など、日常生活で使うフレーズの練習。",
                "非言語的な表現練習: 表情やジェスチャーを使ったコミュニケーション。",
                            ],
            "運動機能の向上": [
                "基礎体力づくり: ストレッチや簡単な体操で筋力と柔軟性を向上。",
                "手先の器用さを鍛える活動: 紐通し、ブロック遊び、ボタンつけなどの指先運動。",
                "歩行やジャンプの練習: 障害物を乗り越える練習でバランス感覚を育てる。",
            ],
            "日常生活スキルの訓練": [
                "買い物練習: 模擬店舗を使い、お金の支払いとお釣りの確認を練習。",
                "時間管理の練習: ピクトグラムや時計を使い、スケジュールを守る練習。",
                "衣服の着脱練習: マジックテープやゴム付き衣類で簡単な着替えから始める。",
            ],
            "社会参加の促進": [
                "グループ活動の練習: 少人数での簡単な役割分担から始め、集団活動に参加。",
                "公共マナーの練習: 電車やバスの使い方、待つ姿勢を学ぶ。",
                "挨拶やお礼の練習: 人と接する際の基本動作を反復する。",
            ],
        },
        "自閉スペクトラム症（ASD）": {
            "スケジュール管理の練習": [
                "視覚的な見通しの提供: 写真や絵カードで1日の流れを示す。",
                "タイマーの活用: 活動時間や休憩時間を視覚化し、予測可能な環境を作る。",
            ],
            "社会性を高める活動": [
                "	ソーシャルスキルトレーニング（SST）: 挨拶や順番待ちなど、具体的な場面のロールプレイを行う。",
                "	感情表現の練習: 表情カードを使って感情の名前や適切な反応を学ぶ。",
           ],
            "感覚への配慮と調整": [
                "感覚統合遊び: ブランコやタッチプールで安心感を育む。",
                "静かな環境での活動: 感覚過敏が強い場合、刺激の少ない部屋での作業を行う。",
            ],
        },
        "注意・欠如・多動性障害（ADHD）": {
            "注意力を育てる活動": [
                "視覚的手がかりの活用: やるべきことをリスト化し、順序立てて行う。",
                "短い課題から始める: 5分程度の簡単な作業から集中力を育てる。",
            ],
            "衝動性の調整": [
                "リラックス法の導入: 深呼吸やヨガなどを行い、衝動をコントロールする練習。",
                "「待つ」練習: ゲームを通じて、指示が出るまで待つ訓練を行う。",
            ],
            "余分なエネルギーの発散": [
                "運動活動: ジャンプやランニングで身体を動かし、多動性を和らげる。",
                "活動と休憩のバランス: 15分作業→5分休憩など、適切なスケジュールを設定。",
            ],
        },
        "自閉スペクトラム症（ASD）": {
            "スケジュール管理の練習": [
                "視覚的な見通しの提供: 写真や絵カードで1日の流れを示す。",
                "タイマーの活用: 活動時間や休憩時間を視覚化し、予測可能な環境を作る。",
            ],
            "社会性を高める活動": [
                "ソーシャルスキルトレーニング（SST）: 挨拶や順番待ちなど、具体的な場面のロールプレイを行う。",
                "感情表現の練習: 表情カードを使って感情の名前や適切な反応を学ぶ。",
           ],
            "感覚への配慮と調整": [
                "感覚統合遊び: ブランコやタッチプールで安心感を育む。",
                "静かな環境での活動: 感覚過敏が強い場合、刺激の少ない部屋での作業を行う。",
            ],
        },
        "学習障害（LD）": {
            "読み書きのサポート": [
                "拡大文字や音声教材の活用: 読むことが苦手な生徒に文字を大きくしたり、音声で補助。",
                "段階的な書字練習: 文字や単語から始め、徐々に文章を書けるようにする。",
            ],
            " 計算のサポート": [
                "具体物を用いた計算: お金やブロックを使って目に見える形で数量を学ぶ。",
                "計算補助機器の利用: 電卓やタブレットを活用し、スムーズな計算を促す。",
            ],
            "学習の成功体験": [
                "興味を引き出す教材選び: 生徒が関心を持つ内容（好きなキャラクターや趣味）を教材に反映する。",
                "達成感を感じやすい課題: 簡単な成功体験を積み重ねることで自己肯定感を高める。",
            ],
        },
        "発達性協調運動障害（DCD）": {
            "動作訓練": [
                "基礎運動の反復: 投げる、捕る、歩くといった基本動作を繰り返し練習。",
                "バランス運動: 平均台を使ったバランス訓練やケンケン遊び。",
            ],
            "手先の巧緻性を高める活動": [
                "運筆練習: 簡単な線や形を描く練習から始める。",
                "手先を使う遊び: 紐通しやビーズ遊びで指先を鍛える。",
           ],
            "自信を育てる活動": [
                "成功体験を重視: 苦手な運動ではなく得意なこと（絵を描く、音楽など）を活かして自信を持たせる。",
                "目標設定の工夫: 小さな達成目標を設定し、達成感を感じさせる。",
            ],
        },
        "四肢・体幹機能障害": {
            "身体的支援と訓練": [
                "基本動作の練習: 寝返り、座る、立つなどの基本動作を繰り返し練習。",
                "リハビリ機器の活用: スタンディングフレームや車椅子での姿勢保持練習。",
            ],
            "コミュニケーションの工夫": [
                "AAC（補助代替コミュニケーション）機器の利用: ボタンを押すことで意思を伝えるスイッチ教材や音声出力デバイス、ジョイスティックマウスや視線入力装置の活用。",
                "ェスチャーや表情の認識練習: 簡単なサインを繰り返し学習する。",
            ],
            "環境への配慮": [
                "感覚刺激の提供: 光や音、触覚遊びで刺激を与え、環境への興味を引き出す。",
                "安全な環境作り: 移動や行動に制限がある場合、安全で快適な空間を確保する。",
                "呼吸器系の健康維持： 呼吸器疾患の予防や痰の粘度の低下、ウイルスの拡散抑制から部屋をよく加湿する必要がある"
            ],
        },
    },
}


# メインメニュー
#menu = st.selectbox("メニューを選択してください", ["指導支援内容"])

# 指導支援内容表示
if menu == "指導支援内容":
    # カテゴリー選択
    selected_category = st.selectbox("1.カテゴリーを選択してください:", list(guidance_data.keys()))
    # 項目選択
    selected_subcategory = st.selectbox(
        "2.該当する項目を選択してください:",
        list(guidance_data[selected_category].keys())
    )
    
    # 辞書かリストかを確認して処理
    if isinstance(guidance_data[selected_category][selected_subcategory], dict):
        selected_detail = st.selectbox(
            "3. 具体的な支援内容を選択してください:",
            list(guidance_data[selected_category][selected_subcategory].keys())
        )
    elif isinstance(guidance_data[selected_category][selected_subcategory], list):
        selected_detail = st.selectbox(
            "3. 具体的な支援内容を選択してください:",
            guidance_data[selected_category][selected_subcategory]
        )
    else:
        st.error("不明なデータ形式です。")
        selected_detail = None

    # 内容表示
    if selected_detail and st.button("適した指導・支援を表示"):
        st.subheader("📌 適した指導・支援")
        # 結果の整形
        if isinstance(guidance_data[selected_category][selected_subcategory], dict):
            detail = guidance_data[selected_category][selected_subcategory][selected_detail]
        else:
            detail = selected_detail

        # リスト形式であれば改行して表示
        if isinstance(detail, list):
            formatted_detail = "\n".join([f"- {item}" for item in detail])
        else:
            formatted_detail = detail

        # 直接表示
        st.markdown(f"**{selected_detail}**:  \n{formatted_detail}")

    # 具体的な支援内容の表示（詳細ボタン付き）
    for item in guidance_data[selected_category][selected_subcategory]:
        if isinstance(item, dict):  # 詳細を持つ項目の場合
            st.markdown(f"**{item['title']}**")
            with st.expander("詳細を見る"):
                for detail in item["details"]:
                    st.write(f"- {detail}")
        else:  # 文字列の項目の場合
            st.write(f"- {item}")

   