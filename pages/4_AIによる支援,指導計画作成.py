import streamlit as st
import pandas as pd
from openpyxl import load_workbook
from openpyxl.styles import Alignment
from io import BytesIO

# --- â–¼ å…±é€šCSSã®èª­ã¿è¾¼ã¿ â–¼ ---
def load_css():
    """ã‚«ã‚¹ã‚¿ãƒ CSSã‚’èª­ã¿è¾¼ã‚€é–¢æ•°"""
    css = """
    <style>
        /* --- èƒŒæ™¯ç”»åƒã®è¨­å®š --- */
        [data-testid="stAppViewContainer"] > .main {
            background-image: linear-gradient(rgba(255,255,255,0.85), rgba(255,255,255,0.85)), url("https://i.imgur.com/AbUxfxP.png");
            background-size: cover;
            background-position: center center;
            background-repeat: no-repeat;
            background-attachment: fixed;
        }
        /* --- æˆ»ã‚‹ãƒœã‚¿ãƒ³ã®ã‚¹ã‚¿ã‚¤ãƒ« (ä½ç½®èª¿æ•´) --- */
        .back-button-container {
            position: relative; /* relativeã«ã—ã¦é€šå¸¸ã®ãƒ•ãƒ­ãƒ¼ã§é…ç½® */
            padding-bottom: 20px; /* ä¸‹ã«ä½™ç™½ */
            margin-bottom: -50px; /* ä¸Šã®è¦ç´ ã¨ã®é‡ãªã‚Šã‚’èª¿æ•´ */
        }
        /* ã‚µã‚¤ãƒ‰ãƒãƒ¼ã®èƒŒæ™¯ã‚’å°‘ã—é€é */
        [data-testid="stSidebar"] {
            background-color: rgba(240, 242, 246, 0.9);
        }
                /* --- â–¼ ã‚µã‚¤ãƒ‰ãƒãƒ¼ã®é–‰ã˜ã‚‹ãƒœã‚¿ãƒ³ã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºï¼ˆæœ€çµ‚ç‰ˆï¼‰â–¼ --- */
        [data-testid="stSidebarNavCollapseButton"] {
            position: relative !important;
            width: 2rem !important;
            height: 2rem !important;
        }
        /* å…ƒã®ã‚¢ã‚¤ã‚³ãƒ³ã‚’å®Œå…¨ã«éè¡¨ç¤ºã«ã™ã‚‹ */
        [data-testid="stSidebarNavCollapseButton"] * {
            display: none !important;
            visibility: hidden !important;
        }
        /* ã‚«ã‚¹ã‚¿ãƒ ã‚¢ã‚¤ã‚³ãƒ³ã€ŒÂ«ã€ã‚’ç–‘ä¼¼è¦ç´ ã¨ã—ã¦è¿½åŠ  */
        [data-testid="stSidebarNavCollapseButton"]::before {
            content: 'Â«' !important;
            display: flex !important;
            justify-content: center !important;
            align-items: center !important;
            position: absolute !important;
            width: 100% !important;
            height: 100% !important;
            top: 0 !important;
            left: 0 !important;
            font-size: 24px !important;
            font-weight: bold !important;
            color: #31333F !important;
            transition: background-color 0.2s, color 0.2s !important;
            border-radius: 0.5rem;
        }
        [data-testid="stSidebarNavCollapseButton"]:hover::before {
            background-color: #F0F2F6 !important;
            color: #8A2BE2 !important;
        }
        /* --- â–² ã‚µã‚¤ãƒ‰ãƒãƒ¼ã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã“ã“ã¾ã§ â–² --- */


        /* --- è¦‹å‡ºã—ã®ã‚¹ã‚¿ã‚¤ãƒ« --- */
        h1 {
            color: #2c3e50; /* ãƒ€ãƒ¼ã‚¯ãƒ–ãƒ«ãƒ¼ */
            text-align: center;
            padding-bottom: 20px;
            font-weight: bold;
        }
        h2 {
            color: #34495e; /* å°‘ã—æ˜ã‚‹ã„ãƒ€ãƒ¼ã‚¯ãƒ–ãƒ«ãƒ¼ */
            border-left: 6px solid #8A2BE2; /* ç´«ã®ã‚¢ã‚¯ã‚»ãƒ³ãƒˆ */
            padding-left: 12px;
            margin-top: 40px;
        }
        h3 {
            color: #34495e;
            border-bottom: 2px solid #4a90e2; /* é’ã®ã‚¢ã‚¯ã‚»ãƒ³ãƒˆ */
            padding-bottom: 8px;
            margin-top: 30px;
        }

        /* --- ã‚«ãƒ¼ãƒ‰ãƒ‡ã‚¶ã‚¤ãƒ³ (st.container(border=True)ã®ã‚¹ã‚¿ã‚¤ãƒ«) --- */
        div[data-testid="stVerticalBlock"] div.st-emotion-cache-1r6slb0 {
            background-color: rgba(255, 255, 255, 0.95);
            border: 1px solid #e0e0e0;
            border-radius: 15px;
            padding: 1.5em 1.5em;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.08);
            transition: box-shadow 0.3s ease-in-out, transform 0 0.3s ease-in-out;
            margin-bottom: 20px; /* ã‚«ãƒ¼ãƒ‰é–“ã®ä½™ç™½ */
        }
        div[data-testid="stVerticalBlock"] div.st-emotion-cache-1r6slb0:hover {
            box-shadow: 0 10px 20px rgba(74, 144, 226, 0.2);
            transform: translateY(-5px);
        }
        
        /* --- ãƒœã‚¿ãƒ³ã®ã‚¹ã‚¿ã‚¤ãƒ« --- */
        .stButton>button {
            border: 2px solid #4a90e2;
            border-radius: 25px;
            color: #4a90e2;
            background-color: #ffffff;
            padding: 10px 24px;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        .stButton>button:hover {
            border-color: #8A2BE2;
            color: white;
            background-color: #8A2BE2;
            transform: scale(1.05);
        }
        /* Primaryãƒœã‚¿ãƒ³ */
        .stButton>button[kind="primary"] {
            background-color: #4a90e2;
            color: white;
            border: none;
        }
        .stButton>button[kind="primary"]:hover {
            background-color: #357ABD;
            border-color: #357ABD;
            transform: scale(1.05);
        }

        /* --- st.infoã®ã‚«ã‚¹ã‚¿ãƒ ã‚¹ã‚¿ã‚¤ãƒ« --- */
        .st-emotion-cache-1wivap1 {
             background-color: rgba(232, 245, 253, 0.7);
             border-left: 5px solid #4a90e2;
             border-radius: 8px;
        }
        
        /* --- â–¼â–¼â–¼ st.expanderã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚¢ã‚¤ã‚³ãƒ³ã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º â–¼â–¼â–¼ --- */
        [data-testid="stExpanderToggleIcon"] {
            display: none; /* ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚¢ã‚¤ã‚³ãƒ³ã‚’éè¡¨ç¤º */
        }
        .st-emotion-cache-p2n28p button { /* st.expanderã®ãƒœã‚¿ãƒ³å…¨ä½“ */
            background-color: #4a90e2; /* é’è‰²ã®èƒŒæ™¯ */
            color: white; /* ç™½ã„æ–‡å­— */
            font-weight: bold;
            border-radius: 10px; /* è§’ã‚’ä¸¸ãã™ã‚‹ */
            padding: 15px 20px; /* ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°ã‚’å¢—ã‚„ã™ */
            width: 100%; /* å¹…ã‚’ã„ã£ã±ã„ã« */
            text-align: left; /* ãƒ†ã‚­ã‚¹ãƒˆã‚’å·¦å¯„ã› */
            transition: background-color 0.3s, transform 0.3s;
            margin-bottom: 10px; /* ä¸‹ã«ä½™ç™½ */
            border: none; /* ãƒœãƒ¼ãƒ€ãƒ¼ã‚’å‰Šé™¤ */
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); /* å½±ã‚’è¿½åŠ  */
            font-size: 1.2em; /* ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºã‚’å¤§ãã */
        }

        .st-emotion-cache-p2n28p button:hover {
            background-color: #8A2BE2; /* ãƒ›ãƒãƒ¼ã§ç´«è‰² */
            transform: translateY(-3px); /* å°‘ã—ä¸Šã«æµ®ãä¸ŠãŒã‚‹ */
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15); /* å½±ã‚’æ¿ƒãã™ã‚‹ */
        }
        /* å±•é–‹æ™‚ã®ãƒœã‚¿ãƒ³ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .st-emotion-cache-p2n28p[aria-expanded="true"] button {
             background-color: #8A2BE2; /* å±•é–‹æ™‚ã¯ç´«è‰² */
             color: white;
        }

        /* å±•é–‹ã‚¢ã‚¤ã‚³ãƒ³ï¼ˆå³çŸ¢å°ï¼‰ã‚’è¿½åŠ  */
        .st-emotion-cache-p2n28p button::after {
            content: 'â–¼'; /* é–‰ã˜ãŸçŠ¶æ…‹ã®ã‚¢ã‚¤ã‚³ãƒ³ */
            float: right;
            font-size: 1em;
            margin-left: 10px;
            transition: transform 0.3s;
        }
        .st-emotion-cache-p2n28p[aria-expanded="true"] button::after {
            content: 'â–²'; /* é–‹ã„ãŸçŠ¶æ…‹ã®ã‚¢ã‚¤ã‚³ãƒ³ */
            transform: rotate(0deg); /* å±•é–‹æ™‚ã¯ä¸Šå‘ã */
        }
        
        /* st.expanderã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„éƒ¨åˆ†ã®ãƒ‘ãƒ‡ã‚£ãƒ³ã‚° */
        div[data-testid="stExpander"] div[data-testid="stVerticalBlock"] {
            padding-top: 10px;
            padding-bottom: 10px;
        }

        /* --- â–²â–²â–² ã“ã“ã¾ã§ â–²â–²â–² --- */

        /* --- ãƒ•ãƒƒã‚¿ãƒ¼ã®åŒºåˆ‡ã‚Šç·š --- */
        .footer-hr {
            border: none;
            height: 3px;
            background: linear-gradient(to right, #4a90e2, #8A2BE2);
            margin-top: 40px;
            margin-bottom: 20px;
        }
    </style>
    """
    st.markdown(css, unsafe_allow_html=True)
# --- â–² å…±é€šCSSã®èª­ã¿è¾¼ã¿ â–² ---

# CSSã‚’é©ç”¨
load_css()

# --- â–¼ æˆ»ã‚‹ãƒœã‚¿ãƒ³ã®é…ç½® (ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®å·¦ä¸Š) â–¼ ---
# st.columnsã‚’ä½¿ã£ã¦ã€å·¦ç«¯ã«é…ç½®ã™ã‚‹
col_back, _ = st.columns([0.15, 0.85]) # ãƒœã‚¿ãƒ³ç”¨ã«ç‹­ã„ã‚«ãƒ©ãƒ ã‚’ç¢ºä¿
with col_back:
    # `st.page_link` ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€ç›´æ¥ãƒšãƒ¼ã‚¸ã«é·ç§»ã§ãã¦ã‚ˆã‚Šç¢ºå®Ÿã§ã™ã€‚
    st.page_link("tokusi_app.py", label="Â« TOPãƒšãƒ¼ã‚¸ã«æˆ»ã‚‹", icon="ğŸ ")
# --- â–² æˆ»ã‚‹ãƒœã‚¿ãƒ³ã®é…ç½® â–² ---

st.title("ğŸ¤– å€‹åˆ¥ã®æ”¯æ´è¨ˆç”»ãƒ»æŒ‡å°è¨ˆç”»ä½œæˆã‚µãƒãƒ¼ãƒˆ")

st.info(
    """
    ã“ã“ã§ã¯ã€å€‹åˆ¥ã®æ”¯æ´è¨ˆç”»ãƒ»æŒ‡å°è¨ˆç”»ã«é–¢ã™ã‚‹æ–‡ç« ã‚’ä½œæˆã™ã‚‹ãŸã‚ã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆï¼ˆAIã¸ã®å‘½ä»¤æ–‡ï¼‰ã‚’ç°¡å˜ã«ä½œæˆã§ãã¾ã™ã€‚
    ä¸‹ã®å„ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’ãƒœã‚¿ãƒ³ã§å±•é–‹ã—ã€å¿…è¦ãªé …ç›®ã‚’å…¥åŠ›ã—ã¦ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ç”Ÿæˆã—ã¦ãã ã•ã„ã€‚
    """
)

# --- â–¼â–¼â–¼ AIãƒãƒ£ãƒƒãƒˆã¸ã®ãƒªãƒ³ã‚¯ â–¼â–¼â–¼ ---
with st.container(border=True):
    st.markdown("""
    <div style="background-color: #e9f5ff; padding: 15px 20px; border: 2px solid #4a90e2; border-radius: 10px;">
        <h2 style="margin-top: 0; color: #2c3e50; border-left: none; text-align: center;">
            ğŸš€ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ã‚³ãƒ”ãƒ¼ã—ãŸã‚‰ã€AIãƒãƒ£ãƒƒãƒˆã¸ï¼
        </h2>
        <p style="text-align: center; font-size: 1.1em; margin-bottom: 15px;">
            ä¸‹ã®ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã¨å„AIãƒãƒ£ãƒƒãƒˆãŒé–‹ãã¾ã™ã€‚ã‚³ãƒ”ãƒ¼ã—ãŸãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’è²¼ã‚Šä»˜ã‘ã¦ã€æ–‡ç« ä½œæˆã‚’å§‹ã‚ã¾ã—ã‚‡ã†ã€‚
        </p>
    </div>
    """, unsafe_allow_html=True)
    
    # ãƒœã‚¿ãƒ³ã‚’ä¸­å¤®ã«é…ç½®ã™ã‚‹ãŸã‚ã®åˆ—
    b_col1, b_col2, b_col3 = st.columns([1, 1.5, 1])
    with b_col2:
        st.link_button("ChatGPT ã‚’é–‹ã„ã¦æ–‡ç« ä½œæˆã‚’å§‹ã‚ã‚‹ â†—", "https://chat.openai.com/", type="primary", use_container_width=True)

    # Geminiã¸ã®ãƒªãƒ³ã‚¯ã‚’è¿½åŠ ï¼ˆtype="primary"ã«å¤‰æ›´ï¼‰
    st.markdown("<br>", unsafe_allow_html=True) # å°‘ã—ä½™ç™½ã‚’è¿½åŠ 
    b_col_g1, b_col_g2, b_col_g3 = st.columns([1, 1.5, 1])
    with b_col_g2:
        st.link_button("Gemini ã‚’é–‹ã„ã¦æ–‡ç« ä½œæˆã‚’å§‹ã‚ã‚‹ â†—", "https://gemini.google.com/", type="primary", use_container_width=True)

st.markdown("<br>", unsafe_allow_html=True) # å°‘ã—ä½™ç™½ã‚’è¿½åŠ 

st.markdown("---") # åŒºåˆ‡ã‚Šç·š

# --- ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆâ‘  ---
with st.expander("ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆâ‘ ã€ãƒ—ãƒ©ãƒ³Aï¼šç‰¹åˆ¥ãªæ•™è‚²çš„ãƒ‹ãƒ¼ã‚ºï¼åˆç†çš„é…æ…®ã€‘"):
    with st.container(border=True):
        st.subheader("ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆâ‘ ã€ãƒ—ãƒ©ãƒ³Aï¼šç‰¹åˆ¥ãªæ•™è‚²çš„ãƒ‹ãƒ¼ã‚ºï¼åˆç†çš„é…æ…®ã€‘") # expanderã®ä¸­ã§ã¯subheaderã«ã™ã‚‹
        jittai_1 = st.text_area("âœ… ãŠå­ã•ã‚“ã®å®Ÿæ…‹ã‚„èª²é¡Œã‚’å…¥åŠ›", value="è¦–åŠ›ãŒå¼±ã„ã€è½ã¡ç€ããŒãªã„ã€ç–²ã‚Œã‚„ã™ã„ã€éŸ³ã«æ•æ„Ÿã€è©±ã—ã‹ã‘ã‚‰ã‚Œã‚‹ã¨æ··ä¹±ã™ã‚‹ã€åŒã˜è¡Œå‹•ã‚’ç¹°ã‚Šè¿”ã™", height=100, key="jittai_1")
        if st.button("ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆâ‘  ã‚’ç”Ÿæˆ", key="btn_1", use_container_width=True):
            st.code(f"""ä»¥ä¸‹ã®å®Ÿæ…‹ã‚„èª²é¡Œã‚’ã‚‚ã¨ã«ã€ç‰¹åˆ¥æ”¯æ´æ•™è‚²ã«é–¢ã™ã‚‹ã€Œãƒ—ãƒ©ãƒ³Aã€ã®ä»¥ä¸‹ã®é …ç›®ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚

ã€å…¥åŠ›ã€‘å®Ÿæ…‹ã‚„èª²é¡Œï¼š
{jittai_1}

ã€å‡ºåŠ›é …ç›®ã€‘ï¼š
1.ç‰¹åˆ¥ãªæ•™è‚²çš„ãƒ‹ãƒ¼ã‚º

ãƒ»å…¥åŠ›ã‹ã‚‰å…±é€šæ€§ã‚’è¦‹å‡ºã—ã€2ï½3ã¤ã®æŠ½è±¡çš„ã‚«ãƒ†ã‚´ãƒªãƒ¼ã«åˆ†é¡ã™ã‚‹ï¼ˆè¡¨è¨˜ã¯â‘ ï½â‘¢ã®å½¢ã€â€»å¿…ãšã—ã‚‚â‘¢ã¾ã§å¿…è¦ã¨ã—ãªã„å…¥åŠ›å†…å®¹ã‚„æ·»ä»˜è³‡æ–™ã«ã‚ˆã‚Šè‡¨æ©Ÿå¿œå¤‰ã«ã€‘ï¼‰ã€‚
ãƒ»å„ãƒ‹ãƒ¼ã‚ºã¯20ã€œ100å­—ç¨‹åº¦ã§ã€å…ç«¥ãƒ»ç”Ÿå¾’ã®å®Ÿæ…‹ã‚’æŸ”ã‚‰ã‹ãæ•™è‚²çš„ã«ã¾ã¨ã‚ã‚‹ã€‚
ãƒ»å…·ä½“çš„ãªå‡ºåŠ›ã®å½¢ã€å‡ºåŠ›ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã€‘
å¯¾è±¡å…ç«¥ï¼ˆç”Ÿå¾’ï¼‰ã¯ç¾åœ¨ã€ä»¥ä¸‹ã®çŠ¶æ³ã§ã‚ã‚‹ã€‚ã€â†å¿…ãšã“ã®æ–‡è¨€ã§å§‹ã‚ã‚‹ã€‘
â‘  ï¼ˆå…¥åŠ›å†…å®¹ã‚’æ•´ç†ã—ã¦ã¾ã¨ã‚ãŸèª²é¡Œã€å›°é›£ã•ã€ç‰¹å¾´ï¼‰
â‘¡ ï¼ˆå…¥åŠ›å†…å®¹ã‚’æ•´ç†ã—ã¦ã¾ã¨ã‚ãŸèª²é¡Œã€å›°é›£ã•ã€ç‰¹å¾´ï¼‰
â‘¢ ï¼ˆå…¥åŠ›å†…å®¹ã‚’æ•´ç†ã—ã¦ã¾ã¨ã‚ãŸèª²é¡Œã€å›°é›£ã•ã€ç‰¹å¾´ï¼‰
â€» å†…å®¹ã¯ã€Œæ—¥å¸¸ç”Ÿæ´»ãƒ»å­¦ç¿’ãƒ»ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ»è¡Œå‹•ãƒ»èº«ä½“ãƒ»æ„Ÿè¦šãƒ»å¿ƒç†ã€ãªã©ã‹ã‚‰ã€å…¥åŠ›å†…å®¹ã«å¿œã˜ã¦é©åˆ‡ã«é¸ã‚“ã§ã¾ã¨ã‚ã‚‹ã“ã¨ã€‚

å¾“ã£ã¦ã€ä»¥ä¸‹ã®æ”¯æ´ãŒå¿…è¦ã§ã‚ã‚‹ã€‚ã€â†å¿…ãšã“ã®æ–‡è¨€ã§å§‹ã‚ã‚‹ã€‘
â‘  ï¼ˆâ‘ ã®çŠ¶æ³ã«å¯¾å¿œã—ãŸæ”¯æ´ç›®æ¨™ã‚„æ–¹æ³•ï¼‰
â‘¡ ï¼ˆâ‘¡ã®çŠ¶æ³ã«å¯¾å¿œã—ãŸæ”¯æ´ç›®æ¨™ã‚„æ–¹æ³•ï¼‰
â‘¢ ï¼ˆâ‘¢ã®çŠ¶æ³ã«å¯¾å¿œã—ãŸæ”¯æ´ç›®æ¨™ã‚„æ–¹æ³•ï¼‰

æ”¯æ´ã«å½“ãŸã£ã¦ã¯ã€ä»¥ä¸‹ã®é…æ…®ãŒå¿…è¦ã§ã‚ã‚‹ã€‚ã€â†å¿…ãšã“ã®æ–‡è¨€ã§å§‹ã‚ã‚‹ã€‘
â‘  ï¼ˆâ‘ ã®çŠ¶æ³ã«å¯¾å¿œã—ãŸé…æ…®ï¼‰
â‘¡ ï¼ˆâ‘¡ã®çŠ¶æ³ã«å¯¾å¿œã—ãŸé…æ…®ï¼‰
â‘¢ ï¼ˆâ‘¢ã®çŠ¶æ³ã«å¯¾å¿œã—ãŸé…æ…®ï¼‰

2.åˆç†çš„é…æ…®ã®å®Ÿæ–½å†…å®¹
ãƒ»ä¸Šè¨˜â‘ ã®ãƒ‹ãƒ¼ã‚ºã«å¯¾å¿œã—ãŸåˆç†çš„é…æ…®ã‚’å°‘ãªãã¨ã‚‚2ã¤ä»¥ä¸Šææ¡ˆã™ã‚‹ã€‚
ãƒ»ã‚·ãƒ³ãƒ—ãƒ«ã«2ã¤ä»¥ä¸Šç®‡æ¡æ›¸ãã§ç¤ºã™ã€‚ï¼ˆä¾‹ï¼šã€Œå…·ä½“ç‰©ã‚’ç¤ºã—ã€è¦–è¦šçš„ãªæ”¯æ´ã‚’è¡Œã†ã€‚ã€ã€ã€Œè½ã¡ç€ã‘ã‚‹ç’°å¢ƒè¨­å®šã«ã™ã‚‹ã€‚ã€ã€ã€Œç”Ÿå¾’ãŒå¥½ããªæ„Ÿè§¦ã®æœ¬ã‚„éŸ³ã®å‡ºã‚‹ç©å…·ç­‰ã‚’æ•™å®¤å†…ã«ç”¨æ„ã—ã€å¿ƒç†çš„å®‰å®šã‚’å›³ã‚‹ã€‚ã€ãªã©ï¼‰ã€‚

ã€æ¡ä»¶ã€‘ï¼š
- æ·»ä»˜è³‡æ–™ãŒã‚ã‚‹å ´åˆï¼ˆã€Œãƒ—ãƒ©ãƒ³Aã€ã‚„ã€Œå€‹åˆ¥ã®æ•™è‚²æ”¯æ´è¨ˆç”»ã€ï¼‰ã«ã‚ã‚‹æ›¸ãæ–¹ã‚’å‚è€ƒã«ã—ã¦ãã ã•ã„ã€‚
- ã“ã®å¾Œã€ã“ã®ã€Œç‰¹åˆ¥ãªæ•™è‚²çš„ãƒ‹ãƒ¼ã‚ºã€ã‚’ã€Œç‰¹åˆ¥ãªæ•™è‚²çš„ãƒ‹ãƒ¼ã‚ºã€â‡’ã€Œæ‰€å±æ ¡ã®æ”¯æ´ç›®æ¨™ã€åŠã³ã€Œå„ç›®æ¨™ã«é€£å‹•ã—ãŸæ”¯æ´å†…å®¹ã€â‡’ã€ŒæŒ‡å°æ–¹é‡ã€ï¼ˆãƒ—ãƒ©ãƒ³Bã‚„å€‹åˆ¥ã®æŒ‡å°è¨ˆç”»ï¼‰ã®é †ã§å…·ä½“åŒ–ã—ã¦ã„ãã®ã§ãã®ã¤ã‚‚ã‚Šã§æŠ½è±¡çš„ã«è¡¨ç¾ã™ã‚‹ã€‚
- ã€Œï½ã§ã™ã€‚ï½ã¾ã™ã€‚ã€èª¿ã§ã¯ãªãã€ã€Œï½ã§ã‚ã‚‹ã€‚ã€èª¿ã§æ–‡ç« ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚
- å„é …ç›®ã®æ–‡é‡ã¯200ã€œ300æ–‡å­—ç¨‹åº¦ã§ã€æŸ”ã‚‰ã‹ãæ•™è‚²çš„ãªè¡¨ç¾ã§æ•´ãˆã¦ãã ã•ã„ã€‚""", language="text")

# --- ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆâ‘¡ ---
with st.expander("ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆâ‘¡ã€ãƒ—ãƒ©ãƒ³Aï¼šæ‰€å±æ ¡ã®æ”¯æ´ã€‘"):
    with st.container(border=True):
        st.subheader("ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆâ‘¡ã€ãƒ—ãƒ©ãƒ³Aï¼šæ‰€å±æ ¡ã®æ”¯æ´ã€‘")
        needs_2 = st.text_area("âœ… ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆâ‘ ã§AIãŒç”Ÿæˆã—ãŸã€Œç‰¹åˆ¥ãªæ•™è‚²çš„ãƒ‹ãƒ¼ã‚ºã€ã‚’è²¼ã‚Šä»˜ã‘", value="â‘  æ„Ÿè¦šéæ•ãŒã‚ã‚Šã€ç’°å¢ƒåˆºæ¿€ã«å½±éŸ¿ã‚’å—ã‘ã‚„ã™ã„\nâ‘¡ æ³¨æ„ã®æŒç¶šãŒé›£ã—ãã€é›†ä¸­ãŒé€”åˆ‡ã‚Œã‚„ã™ã„\nâ‘¢ ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«æ··ä¹±ãŒè¦‹ã‚‰ã‚Œã€ä¸€æ–‰æŒ‡ç¤ºã«åå¿œã—ã¥ã‚‰ã„", height=150, key="needs_2")
        if st.button("ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆâ‘¡ ã‚’ç”Ÿæˆ", key="btn_2", use_container_width=True):
            st.code(f"""ä»¥ä¸‹ã®ã€Œç‰¹åˆ¥ãªæ•™è‚²çš„ãƒ‹ãƒ¼ã‚ºã€ã«åŸºã¥ã„ã¦ã€ã€Œæ‰€å±æ ¡ã«ã‚ˆã‚‹æ”¯æ´è¨ˆç”»ï¼ˆãƒ—ãƒ©ãƒ³Aï¼‰ã€ã®é …ç›®ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚

ã€å‚è€ƒã€‘ç‰¹åˆ¥ãªæ•™è‚²çš„ãƒ‹ãƒ¼ã‚ºï¼š
{needs_2}

ã€å‡ºåŠ›é …ç›®ã€‘ï¼š
ãƒ»1æ‰€å±æ ¡ã®æ”¯æ´ç›®æ¨™ãƒ»æ©Ÿé–¢åã€2æ”¯æ´å†…å®¹ã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ç”Ÿæˆã€€â€»æ©Ÿé–¢åã¯ãã†ã„ã†è¡¨è¨˜ãŒã•ã‚Œã¦ã„ã‚‹ã ã‘ã§ã€æ„å‘³ã¯ç„¡è¦–ã—ã¦è‰¯ã„ã‚¿ã‚¤ãƒˆãƒ«ã¯ãã®ã¾ã¾ã§ã€‚
1.æ‰€å±æ ¡ã®æ”¯æ´ç›®æ¨™ãƒ»æ©Ÿé–¢å  
ï¼ˆç‰¹åˆ¥ãªæ•™è‚²çš„ãƒ‹ãƒ¼ã‚ºã®â‘ ï½â‘¢ã«å¯¾å¿œã—ã¦ä½œæˆã€‚â‘¡ã¾ã§ã—ã‹ãªã„å ´åˆã¯â‘¡ã¾ã§ã§ã‚ˆã„ã€‚ï¼‰

â‘ ç›®æ¨™ï¼šï¼ˆ30å­—ä»¥å†…ç¨‹åº¦ãƒ»çŸ­ãã¦ã‚‚ã‚ˆã„ï¼‰  
â‘¡ç›®æ¨™ï¼šï¼ˆ30å­—ä»¥å†…ç¨‹åº¦ãƒ»çŸ­ãã¦ã‚‚ã‚ˆã„ï¼‰    
â‘¢ç›®æ¨™ï¼šï¼ˆ30å­—ä»¥å†…ç¨‹åº¦ãƒ»çŸ­ãã¦ã‚‚ã‚ˆã„ï¼‰  

2.æ”¯æ´å†…å®¹  
ï¼ˆä¸Šè¨˜ã®â‘ ï½â‘¢ã®ç›®æ¨™ãã‚Œãã‚Œã«å¯¾å¿œã—ã¦ä½œæˆã€‚ï¼‰

â‘ ï¼ˆ50å­—ä»¥å†…ç¨‹åº¦ã§ã€å­¦æ ¡ç¾å ´ã§å®Ÿè·µå¯èƒ½ãªæ”¯æ´å†…å®¹ã‚’è¨˜è¼‰ï¼‰  
â‘¡ï¼ˆ50å­—ä»¥å†…ç¨‹åº¦ã§ã€å­¦æ ¡ç¾å ´ã§å®Ÿè·µå¯èƒ½ãªæ”¯æ´å†…å®¹ã‚’è¨˜è¼‰ï¼‰  
â‘¢ï¼ˆ50å­—ä»¥å†…ç¨‹åº¦ã§ã€å­¦æ ¡ç¾å ´ã§å®Ÿè·µå¯èƒ½ãªæ”¯æ´å†…å®¹ã‚’è¨˜è¼‰ï¼‰

ãƒ»å…·ä½“çš„ãªå‡ºåŠ›ã®å½¢ã€å‡ºåŠ›ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã€‘ 
ã“ã®ã‚ˆã†ãªæŠ½è±¡çš„ãªè¡¨ç¾ã§ã‚ˆã„ï¼ˆæ¬¡ã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã§ã‚ˆã‚Šå…·ä½“åŒ–ã™ã‚‹ãŸã‚ï¼‰ã€‚  


ã€æ¡ä»¶ã€‘ï¼š
- ã€Œç‰¹åˆ¥ãªæ•™è‚²çš„ãƒ‹ãƒ¼ã‚ºã€ã¨å¯¾å¿œãŒåˆ†ã‹ã‚‹ã‚ˆã†ã«â‘ ï½â‘¢ã®ç•ªå·ã‚’æƒãˆã‚‹ã“ã¨ã€‚  
- å„æ–‡ã¯çŸ­ãã¦ã‚‚ã‚ˆã„ãŒã€æ•™è‚²çš„ã§æŸ”ã‚‰ã‹ã„è¡¨ç¾ã«ã™ã‚‹ã“ã¨ã€‚  
- ã€Œï½ã§ã™ã€‚ï½ã¾ã™ã€‚ã€èª¿ã§ã¯ãªãã€ã€Œï½ã§ã‚ã‚‹ã€‚ã€èª¿ã§çµ±ä¸€ã™ã‚‹ã“ã¨ã€‚  
- æ·»ä»˜è³‡æ–™ï¼ˆã€Œãƒ—ãƒ©ãƒ³Aã€ã‚„ã€Œå€‹åˆ¥ã®æ•™è‚²æ”¯æ´è¨ˆç”»ã€ï¼‰ã®æ›¸ãæ–¹ã‚’å‚è€ƒã«ã—ã¦ã‚ˆã„ã€‚  
- ã“ã“ã§ã¯æŠ½è±¡çš„ã«ã¾ã¨ã‚ã€**æ¬¡ã®æ®µéšï¼ˆãƒ—ãƒ©ãƒ³Bãªã©ï¼‰ã§å…·ä½“åŒ–ã—ã¦ã„ããŸã‚ã®åŸºç¤**ã¨ã—ã¦ä½œæˆã™ã‚‹ã“ã¨ã€‚""", language="text")

# --- ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆâ‘¢ ---
with st.expander("ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆâ‘¢ã€ãƒ—ãƒ©ãƒ³Bï¼šæŒ‡å°æ–¹é‡ãƒ»7é …ç›®ã®å®Ÿæ…‹ã€‘"):
    with st.container(border=True):
        st.subheader("ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆâ‘¢ã€ãƒ—ãƒ©ãƒ³Bï¼šæŒ‡å°æ–¹é‡ãƒ»7é …ç›®ã®å®Ÿæ…‹ã€‘")
        jittai_3 = st.text_area("âœ… ãŠå­ã•ã‚“ã®å®Ÿæ…‹ã‚„èª²é¡Œã‚’å…¥åŠ›ï¼ˆãƒ—ãƒ­ãƒ³ãƒ—ãƒˆâ‘ ã¨åŒã˜ã§OKï¼‰", value="è¦–åŠ›ãŒå¼±ã„ã€è½ã¡ç€ããŒãªã„ã€ç–²ã‚Œã‚„ã™ã„ã€éŸ³ã«æ•æ„Ÿã€è©±ã—ã‹ã‘ã‚‰ã‚Œã‚‹ã¨æ··ä¹±ã™ã‚‹ã€åŒã˜è¡Œå‹•ã‚’ç¹°ã‚Šè¿”ã™", height=100, key="jittai_3")
        if st.button("ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆâ‘¢ ã‚’ç”Ÿæˆ", key="btn_3", use_container_width=True):
            st.code(f"""ä»¥ä¸‹ã®å®Ÿæ…‹ãƒ»èª²é¡Œã‚’ã‚‚ã¨ã«ã€ç‰¹åˆ¥æ”¯æ´è¨ˆç”»ã€Œãƒ—ãƒ©ãƒ³Bã€ã®é …ç›®ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚

ã€å…¥åŠ›ã€‘å®Ÿæ…‹ãƒ»èª²é¡Œï¼š
{jittai_3}

ã€å‡ºåŠ›é …ç›®ã€‘

1.æŒ‡å°æ–¹é‡
ãƒ»ã€Œç‰¹åˆ¥ãªæ•™è‚²çš„ãƒ‹ãƒ¼ã‚ºâ‘ ï½â‘¢ã€ã¨ã€Œæ‰€å±æ ¡ã®æ”¯æ´ç›®æ¨™â‘ ï½â‘¢ã€ã‚’è¸ã¾ãˆã€ã‚ˆã‚Šå…·ä½“çš„ãªæŒ‡å°ã®æ–¹å‘æ€§ã‚’ç¤ºã™ã€‚
ãƒ»å…ç«¥ç”Ÿå¾’ã®å®Ÿæ…‹ã‚’å†’é ­ã§ä¸å¯§ã«æå†™ã—ã€ãã®å¾Œã«å¿…è¦ãªæŒ‡å°å†…å®¹ã‚’â‘ ï½â‘¢ã«æ•´ç†ã™ã‚‹ã€‚
ãƒ»å…¨ä½“ã‚’é€šã—ã¦300ã€œ500å­—ç¨‹åº¦ã¨ã—ã€æ•™è‚²çš„ã§æŸ”ã‚‰ã‹ã„è¡¨ç¾ã‚’ç”¨ã„ã‚‹ã€‚
ãƒ»æ–‡ç« ãŒé•·ããªã‚‹å ´åˆã¯è¤‡æ•°å›ã«åˆ†ã‘ã¦å‡ºåŠ›ã—ã¦ã‚ˆã„ã€‚

2.å®Ÿæ…‹ï¼ˆç‰¹åˆ¥æ”¯æ´ã«ãŠã‘ã‚‹7åŒºåˆ†ã€”ç®‡æ¡æ›¸ãã§ã€ä¾‹ï¼šã€ç€æ›¿ãˆã€‘ãƒ»ï½ã®å½¢ã€•ï¼‰
ãƒ»ä»¥ä¸‹ã®åŒºåˆ†ã”ã¨ã«é …ç›®ã‚’ã‚‚ã†ã‘ã¦ï¼ˆå†…å®¹ã«ã‚ˆã£ã¦é …ç›®ã®æ•°ã«åã‚ŠãŒã‚ã£ã¦ã‚‚ã‚ˆã„ï¼‰è¨˜è¿°ã™ã‚‹ã€‚å„åŒºåˆ†ã«ä¾‹ã‚’è¨­ã‘ã‚‹ã®ã§å‚è€ƒã«ã—ã¦ãã ã•ã„
â‘  å¥åº·ã®ä¿æŒï¼ˆæ—¥å¸¸ç”Ÿæ´»é¢ã€å¥åº·é¢ãªã©ï¼‰ã€ç€æ›¿ãˆã€‘ã€é£Ÿäº‹ã€‘ã€æ’æ³„ã€‘ã€å¥åº·ä¸Šã®é…æ…®ã€‘
ï¼ˆã“ã®åŒºåˆ†ã¯å¤šã‚ã«é …ç›®ã‚’è¨­ã‘ã‚‹ã€ä¾‹ï¼šã€ç€æ›¿ãˆã€‘ãƒ»ã‚ºãƒœãƒ³ã«ã¯ãƒ¯ãƒƒãƒšãƒ³ã‚’ã¤ã‘ã‚‹ã¨å‰å¾ŒãŒã‚ã‹ã£ã¦å±¥ãã“ã¨ãŒã§ãã‚‹ã€‚ãƒ»è¨€è‘‰ã‹ã‘ã‚’å—ã‘ã¦è„±ã„ã æœã®è£è¿”ã—ã‚’ç›´ã™ã“ã¨ãŒã§ãã‚‹ã€‚ãƒ»ç™»æ ¡æ™‚ã¯ã‚ªãƒ ãƒ„ã‚’ç€ç”¨ã—ã¦ã„ã‚‹ã€‚ç™»æ ¡å¾Œã«å¸ƒãƒ‘ãƒ³ãƒ„ã«å±¥ãæ›¿ãˆã¦ã„ã‚‹ã€‚ãƒ»ä¸‹æ ¡æ™‚ã¯å¸ƒãƒ‘ãƒ³ãƒ„ã‚’ä½¿ç”¨ã™ã‚‹ã€‚ãƒ‡ã‚¤ã‚µãƒ¼ãƒ“ã‚¹ã«ã‚ˆã‚Šå¸°ã‚Šéš›ã«ãƒˆã‚¤ãƒ¬ã«è¡Œã‹ã›ã‚‹ã€‚ã€é£Ÿäº‹ã€‘ãƒ»é£Ÿäº‹ã¯å°‘é‡ãšã¤åˆ¥çš¿ã«å…¥ã‚Œã¦æä¾›ã—ã¦ã„ã‚‹ã€‚ã¾ãŸã€å·¦æ‰‹ã‚’ãŠæ¤€ã«æ·»ãˆã¦ã€å³æ‰‹ã§ã‚¹ãƒ—ãƒ¼ãƒ³ã‚„è£œåŠ©å…·ä»˜ãã®ç®¸ã‚’ä½¿ç”¨ã—ã¦é£Ÿã¹ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚ã€æ’æ³„ã€‘ãƒ»ç«‹ã¡ä¾¿å™¨ã‚’ä½¿ã†ã“ã¨ãŒã§ãã‚‹ã€‚ã€å¥åº·ä¸Šã®é…æ…®ã€‘ãƒ»æ˜¥ã¯èŠ±ç²‰ç—‡ã®è–¬ã‚’æœç”¨ã—ã¦ã„ã‚‹ã€‚ãªã©ã€‘ï¼‰
â‘¡ å¿ƒç†çš„ãªå®‰å®šï¼ˆæƒ…ç·’é¢ã€çŠ¶æ³ã®ç†è§£ãªã©ï¼‰ã€è‹¦æ‰‹ãªçŠ¶æ³ã€‘
ã€ä¾‹ï¼šã€è‹¦æ‰‹ãªçŠ¶æ³ã€‘ãƒ»æ€¥ãªéŸ³ã‚„å¤§ããªéŸ³ã¯è‹¦æ‰‹ã§ã€é©šã„ã¦ä¸å®‰å®šã«ãªã‚‹ã“ã¨ãŒã‚ã‚‹ã€‚ãƒ»æ°—æŒã¡ãŒä¸å®‰å®šãªæ™‚ã¯ã€é¦–ã«æ´ã¿ã‹ã‹ã‚ã†ã¨ã—ãŸã‚Šã€å™›ã‚‚ã†ã¨ã—ãŸã‚Šã™ã‚‹ã“ã¨ãŒã‚ã‚‹ã€‚ãƒ»æš‘ã„å­£ç¯€ã¯è‹¦æ‰‹ã§ã€å¤å ´ã¯æ°—æŒã¡ãŒä¸å®‰å®šã«ãªã‚‹ã“ã¨ãŒå¤šã„ã€‚æ±—ã‚’æ‹­ãã“ã¨ã«ã‚ˆã‚Šæ°—æŒã¡ãŒè½ã¡ç€ãã“ã¨ãŒã‚ã‚‹ã€‚ãƒ»æ°—æŒã¡ãŒä¸å®‰å®šãªæ™‚ã«ã€ã‚¤ãƒ¤ãƒ¼ãƒãƒ•ã‚’ç€ç”¨ã—ã¦ã„ã‚‹ã€‚ãƒ»æ°—æŒã¡ãŒä¸å®‰å®šãªã¨ãã«æ·±å‘¼å¸ã‚’ä¿ƒã—ãŸã‚Šã€æ•™å“¡ãŒèƒ¸ã‚„èƒŒä¸­ã‚’ãƒˆãƒ³ãƒˆãƒ³å©ã„ãŸã‚Šã™ã‚‹ã¨è½ã¡ç€ãã“ã¨ãŒã‚ã‚‹ã€‚ï¼ˆæ„Ÿè¦šçµ±åˆã€å‰¯äº¤æ„Ÿç¥çµŒï¼‰ã€ãã®ä»–ã€‘ãƒ»æ­©ã„ãŸã‚Šã€èº«ä½“ã‚’å‹•ã‹ã—ãŸã‚Šã™ã‚‹ã“ã¨ãŒå¥½ãã§ã€æ•£æ­©ã‚’ã™ã‚‹ã“ã¨ã§æ°—æŒã¡ã‚’åˆ‡ã‚Šæ›¿ãˆã‚‰ã‚Œã‚‹ã“ã¨ãŒã‚ã‚‹ã€‚ãƒ»è¦‹é€šã—ã®æŒã¡ã‚„ã™ã„èª²é¡Œã«ã¯ï¼“ï¼åˆ†ç¨‹åº¦é›¢å¸­ã›ãšã«å–ã‚Šçµ„ã‚€ã“ã¨ãŒã§ãã‚‹ã€‚ãƒ»è¦‹é€šã—ã®æŒã¡ã«ãã„å ´é¢ã‚„ã€æ°—æŒã¡ãŒå‘ã‹ãªã„æ´»å‹•ã®æ™‚ã«ã¯ãƒˆã‚¤ãƒ¬ã«è¡Œã“ã†ã¨ã™ã‚‹ã“ã¨ãŒã‚ã‚‹ã€‚ãƒ»æ€’ã‚‹ã¨è¿‘ãã«ã‚ã‚‹ç‰©ã‚’å™›ã‚€ç™–ãŒã‚ã‚‹ã€‚(ã‹ãªã‚Šæ¸›ã£ã¦ããŸ)ã€‘
â‘¢ äººé–“é–¢ä¿‚ã®å½¢æˆï¼ˆäººã¨ã®ã‹ã‹ã‚ã‚Šã€é›†å›£ã¸ã®å‚åŠ ãªã©ï¼‰ã€å¤§äººã‚„å‹é”ã¨ã®é–¢ã‚ã‚Šã€‘ã€é›†å›£å‚åŠ ã€‘
ã€ä¾‹ï¼šã€å¤§äººã‚„å‹é”ã¨ã®é–¢ã‚ã‚Šã€‘ãƒ»æ•™å“¡ã‹ã‚‰ã®å‘¼ã³ã‹ã‘ã«åå¿œã—ã€è¡Œå‹•ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚ãƒ»èº«è¿‘ãªå¤§äººã®è†ã®ä¸Šã«ä¹—ã‚ã†ã¨ã—ãŸã‚Šã€æŠ±ãç€ã“ã†ã¨ã—ãŸã‚Šã™ã‚‹ãªã©ã®èº«ä½“ãƒ»æ¥è§¦ãŒå¥½ãã§ã‚ã‚‹ã€‚ã€é›†å›£å‚åŠ ã€‘ãƒ»èª°ã¨ã§ã‚‚æ‰‹ã‚’ç¹‹ã„ã ã‚Šã€é–¢ã‚ã£ãŸã‚Šã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚ã€‘
â‘£ ç’°å¢ƒã®æŠŠæ¡ï¼ˆæ„Ÿè¦šã®æ´»ç”¨ã€èªçŸ¥é¢ã€å­¦ç¿’é¢ãªã©ï¼‰ã€å­¦ç¿’ã®æ§˜å­ã€‘
ã€ä¾‹ï¼šã€å­¦ç¿’ã®æ§˜å­ã€‘ãƒ»ã‚·ãƒ¼ãƒ«ã‚’è‡ªåˆ†ã§å¥½ããªã‚ˆã†ã«è²¼ã‚Œã‚‹ã€‚ä¸¸ã„ç´™ã‚„ã‚¿ã‚¤ãƒ«ã‚’ä¸€ç›´ç·šã«è²¼ã‚Œã‚‹ã€‚ãƒ»è‰²ã®åŒºåˆ¥ãŒã§ãã‚‹ã€‚ãƒ»ï¼“ï¼é¢ã¾ã§ã®ãƒ‘ã‚ºãƒ«ãŒã§ãã‚‹ã€‚ãƒ»ã²ã‚‰ãŒãªã‚„ã‚¤ãƒ©ã‚¹ãƒˆã®ãƒãƒƒãƒãƒ³ã‚°ãŒã§ãã‚‹ã€‚ã€‘
â‘¤ èº«ä½“ã®å‹•ãï¼ˆé‹å‹•ãƒ»å‹•ä½œã€ä½œæ¥­é¢ãªã©ï¼‰ã€èº«ä½“ã®å‹•ãã€‘ã€æ‰‹æŒ‡ã®æ“ä½œã€‘
ã€ä¾‹ï¼šã€èº«ä½“ã®å‹•ãã€‘ãƒ»éŸ³æ¥½ãŒå¥½ãã§ã€è´ããªãŒã‚‰èº«ä½“ã‚’å‹•ã‹ã™ã“ã¨ãŒã§ãã‚‹ã€‚ãƒ»ãƒ–ãƒ©ãƒ³ã‚³ã«ä¸€äººã§ä¹—ã‚Œã‚‹ã€‚ãƒ»ãƒœãƒ¼ãƒ«ã‚’æŠ•ã’ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚æ”¯æ´ã‚’å—ã‘ã¦ãƒœãƒ¼ãƒ«ã‚’è¹´ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚ã€æ‰‹æŒ‡ã®æ“ä½œã€‘ãƒ»åˆ©ãæ‰‹ãŒã¾ã å®šã¾ã£ã¦ã„ãªã„ãŒã€å³æ‰‹ã‚’æ—¥å¸¸çš„ã«ä½¿ç”¨ã™ã‚‹ã€‚ãƒ»æ”¯æ´ã‚’å—ã‘ã¦ãƒã‚µãƒŸã‚„ã®ã‚Šãªã©ã®é“å…·ã‚’ä½¿ã†ã“ã¨ãŒã§ãã‚‹ã€‚ãƒ»ç²—å¤§æ¨¡å€£ã¯ã€æ•™å“¡ã®æ‰‹æœ¬ã‚„æ˜ åƒã‚’è¦³ãŸã‚Šã—ãªãŒã‚‰è¡Œã†ã“ã¨ãŒã§ãã‚‹ã€‚ãƒ»ã¤ã¾ã‚€ã€ã²ã­ã‚‹ã€å›ã™ã€æŠ¼ã™ãªã©æ‰‹æŒ‡ã‚’ä½¿ã£ãŸæ´»å‹•ãŒã§ãã‚‹ã€‚ãƒ»çˆªãŒãªã„ãŸã‚å¾®ç´°ãªå‹•ãã¯è‹¦æ‰‹ã§ã‚ã‚‹ã€‚ãƒ»è‡ªåŠ©ç®¸ã‚’ä½¿ç”¨ã—ã¦é£Ÿäº‹ãŒå–ã‚Œã‚‹ã€‚ã€‘
â‘¥ ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆæ„æ€ã®ä¼é”ã€è¨€èªã®å½¢æˆãªã©ï¼‰ã€ï½ºï¾ï½­ï¾†ï½¹ï½°ï½¼ï½®ï¾ã®ç†è§£ã€‘ã€ï½ºï¾ï½­ï¾†ï½¹ï½°ï½¼ï½®ï¾ã®è¡¨å‡ºã€‘
ã€ä¾‹ï¼šã€ï½ºï¾ï½­ï¾†ï½¹ï½°ï½¼ï½®ï¾ã®ç†è§£ã€‘ãƒ»æ•™å“¡ã®æŒ‡ç¤ºã‚’ã‚ã‚‹ç¨‹åº¦ç†è§£ã—ã¦ã„ã¦ã€æŒ‡ç¤ºé€šã‚Šå‹•ãã“ã¨ãŒã§ãã‚‹ã€‚ã€ï½ºï¾ï½­ï¾†ï½¹ï½°ï½¼ï½®ï¾ã®è¡¨å‡ºã€‘ãƒ»ä¿ƒã•ã‚Œã‚‹ã¨ï½¤ã€Œã¡ã‚‡ã†ã ã„ã€ã®ã‚µã‚¤ãƒ³ã‚’å‡ºã™ã“ã¨ãŒã§ãã‚‹ã€‚ã‚µã‚¤ãƒ³ã¨ä¸€ç·’ã«ãƒ»å£ã‚’å‹•ã‹ã™ã“ã¨ãŒã§ãã‚‹ã€‚ã‚µã‚¤ãƒ³ã‚’å‡ºã—ã¦ã„ã‚‹å¤§äººã«ç‰©ã‚’æ¸¡ã™ã“ã¨ãŒã§ãã‚‹ã€‚ãƒ»æ•™å“¡ã‚’å‘¼ã¶ã¨ãã«ã€è‚©ã‚’ãƒˆãƒ³ãƒˆãƒ³ã¨å©ãã“ã¨ãŒã§ãã‚‹ã€‚ãƒ»ã€Œãƒˆã‚¤ãƒ¬ã€ã€Œã”ã‚ã‚“ã€ãªã©ç°¡å˜ãªè¨€è‘‰ã®ç™ºèªãŒã§ãã‚‹ã€‚ãƒ»æ’æ³„ã®æ„æ€è¡¨ç¤ºã¯ã€Œãƒˆã‚¤ãƒ¬ã€ã¨ä¼ãˆã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚ãƒ»å£å½¢æ¨¡å€£ã‚„å˜éŸ³ã®ç™ºå£°ã¯ã§ãã‚‹ã‚ˆã†ã«ãªã£ã¦ãã¦ã„ã‚‹ã€‚ã€‘
â‘¦ ãã®ä»–ï¼ˆæ€§æ ¼ã€è¡Œå‹•ç‰¹å¾´ã€èˆˆå‘³é–¢å¿ƒãªã©ï¼‰ã€èˆˆå‘³é–¢å¿ƒã€‘
ã€ä¾‹ï¼šã€èˆˆå‘³é–¢å¿ƒã€‘ãƒ»æ´»å‹•ä¸­ã«èº«ä½“ã‚’å¤§ããå·¦å³ã«å‹•ã‹ã—ãŸã‚Šé£›ã³è·³ã­ãŸã‚Šã™ã‚‹ã¨ããŒã‚ã‚‹ã€‚ãƒ»ãŠã‚‚ã¡ã‚ƒã‚’åºŠã«ãŸãŸãã¤ã‘ã‚‹ã‚ˆã†ã«æŠ•ã’ã‚‹ã€‚ã€‘
ãƒ»ã€å…¥åŠ›ã€‘ã®å®Ÿæ…‹ãƒ»èª²é¡Œã‚’ã‚‚ã¨ã«ã€å¯èƒ½ãªé™ã‚Šå¤šãã®å…·ä½“çš„å†…å®¹ã‚’ç››ã‚Šè¾¼ã‚€ã€‚
ãƒ»1å›ã§æ›¸ããã‚Œãªã„å ´åˆã¯ã€ä½•å›ã«ãªã£ã¦ã‚‚ã‚ˆã„ã®ã§ã€è¤‡æ•°å›ã«åˆ†ã‘ã¦å‡ºåŠ›ã™ã‚‹ã€‚

ã€æ¡ä»¶ã€‘ï¼š
- æ·»ä»˜è³‡æ–™ãŒã‚ã‚Œã°å‚è€ƒã«ã—ã¦ãã ã•ã„ï¼ˆãƒ—ãƒ©ãƒ³Bã‚„å€‹åˆ¥ã®æŒ‡å°è¨ˆç”»ï¼‰ã€‚
- ã€Œï½ã§ã™ã€‚ï½ã¾ã™ã€‚ã€èª¿ã§ã¯ãªãã€ã€Œï½ã§ã‚ã‚‹ã€‚ã€èª¿ã§æ–‡ç« ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚
- ã€å…¥åŠ›ã€‘ã®å†…å®¹ã ã‘ã§ãªãã€ã“ã‚Œã¾ã§ã®ç‰¹åˆ¥ãªæ•™è‚²çš„ãƒ‹ãƒ¼ã‚ºã¨æ‰€å±æ ¡ã®æ”¯æ´ç›®æ¨™ã‹ã‚‰ç™ºå±•ã•ã›ã¦ä½œæˆã™ã‚‹ã€‚
- ã€Œ1.æŒ‡å°æ–¹é‡ã€ç‰¹åˆ¥ãªæ•™è‚²çš„ãƒ‹ãƒ¼ã‚ºã¨æ‰€å±æ ¡ã®æ”¯æ´ç›®æ¨™ã‚ˆã‚Šå…·ä½“çš„ãªå†…å®¹ã«ã™ã‚‹
- ã€Œ1.æŒ‡å°æ–¹é‡ã€ã¯ç‰¹åˆ¥ãªæ•™è‚²çš„ãƒ‹ãƒ¼ã‚ºã¨æ‰€å±æ ¡ã®æ”¯æ´ç›®æ¨™ã®â‘ ï½â‘¢ã«é€£å‹•ã—ãŸå½¢ã§ï¼ˆâ‘¡ã¾ã§ã—ã‹ãªã„å ´åˆã¯åŒæ§˜ã«â‘ ã€â‘¡ã§OKï¼‰
- â‘  æŒ‡å°æ–¹é‡ã®ä¾‹ï¼šã€Œç¾åœ¨ã€æœ¬ç”Ÿå¾’ã¯ã€å³ç›®ã®è¦–åŠ›ãŒç„¡ãå·¦ç›®ã‚‚è¦–åŠ›ãŒå¼±ãè¦–é‡ãŒç‹­ã„ã€‚ã¾ãŸã€è´åŠ›ã¯ã€å…¨ãèã“ãˆã¦ã„ãªã„ã¨æ€ã‚ã‚Œã€æ—¥å¸¸ç”Ÿæ´»ã®æ®†ã©ã‚’æ•™å“¡ã«ä»»ã›ãã‚Šã«ã—ã¦ã„ãŸã‚Šã€æ•™å“¡ã«å¯¾ã—ã¦å¸¸ã«è§¦ã‚Œåˆã„ãƒ»æºã•ã¶ã‚Šãªã©ã®åˆºæ¿€ã‚’æ±‚ã‚ã¦ã„ã‚‹ã€‚ã¾ãŸã€ä¸é©åˆ‡ãªè¡Œå‹•ãŒå¤šãè¦‹ã‚‰ã‚Œã€åˆºæ¿€ã‚’æ±‚ã‚ã¦ã€è‡ªåˆ†ã®é¡”ã«å”¾ã‚„æ°´ãƒ»ãŠã—ã£ã“ã‚’ã‹ã‘ãŸã‚Šã€å¹ãå‡ºã—ãŸã‚Šã™ã‚‹ã“ã¨ã‚„ç‰©ã‚’æŠ•ã’ãŸã‚Šã€å€’ã—ãŸã‚Šè¡å‹•çš„ãªè¡Œå‹•ã€äººã¨ã®ã‹ã‹ã‚ã‚Šã®ä¸­ã§æŠ“ã£ãŸã‚Šã€å©ã„ãŸã‚Šã€é«ªã®æ¯›ã‚’å¼•ã£å¼µã£ãŸã‚Šã™ã‚‹ã“ã¨ãŒã‚ã‚‹ã€‚ã‚³ãƒŸãƒ¥ã‚±ãƒ¼ã‚·ãƒ§ãƒ³é¢ã§ã¯ã€æ‰‹è©±ã«ã‚ˆã‚‹ã‚µã‚¤ãƒ³ãŒï¼’ï½ï¼“å€‹ç†è§£ã§ãã‚‹ã€‚ã¾ãŸã€è‡ªåˆ†ã§1å€‹ã€Œãƒˆã‚¤ãƒ¬ã€ã®ã‚µã‚¤ãƒ³ã‚’è¡Œã†æ™‚ãŒã‚ã‚‹ã€‚ãã®ä»–ã€ç›¸æ‰‹ã®æ‰‹ã‚’å–ã‚Šç›´æ¥æ‰‹ã‚’å‹•ã‹ã—ã¦ã®è¦æ±‚ã‚’ã™ã‚‹ã“ã¨ãŒå¤šã„ã€‚
å¾“ã£ã¦ã€ä»¥ä¸‹ã®â‘ ï½â‘¢ã®æŒ‡å°ãŒå¿…è¦ã ã¨è€ƒãˆã‚‹ã€‚
ã€€â‘ ãƒˆã‚¤ãƒ¬ã‚„é£Ÿäº‹ã€ç€æ›¿ãˆãªã©æ—¥å¸¸ç”Ÿæ´»ã®ä¸­ã§ã€æ•™å“¡ã«é ¼ã‚‰ãšã«ã²ã¨ã‚Šã§ã§ãã‚‹ã“ã¨ã‚’å¢—ã‚„ã™ã€‚
ã€€â‘¡ä¸é©åˆ‡è¡Œå‹•ãŒèµ·ããŸæ™‚ã«ç¹°ã‚Šè¿”ã•ãªã„ã‚ˆã†ã«ã™ã‚‹ã€‚
ã€€â‘¢çµµã‚«ãƒ¼ãƒ‰ã‚„æ‰‹è©±ã«ã‚ˆã‚‹è¦æ±‚ã‚’å¢—ã‚„ã™ã€‚
ã“ã‚Œã‚‰ã®æŒ‡å°ã‚’å…ƒã«æœ¬ç”Ÿå¾’ã®ç”Ÿæ´»é¢ã§ã®è‡ªç«‹ã€è¡Œå‹•é¢ãƒ»ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³é¢ã§ã®æˆé•·ã«ã¤ãªã’ã¦ã„ãã€‚ã€
- 1å›ã§æ›¸ããã‚Œãªã„å ´åˆã¯ã€ä½•å›ã«ãªã£ã¦ã‚‚ã‚ˆã„ã®ã§ã€è¤‡æ•°å›ã«åˆ†ã‘ã¦å‡ºåŠ›ã™ã‚‹ã€‚
- æŒ‡å°æ–¹é‡ã¯å…¨ä½“çš„ãªè¦–ç‚¹ã§ã€å„å®Ÿæ…‹ã¯200ã€œ300æ–‡å­—ã§ä¸å¯§ã«æå†™ã—ã¦ãã ã•ã„ã€‚""", language="text")

 # --- æ–°ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆâ‘£ ---
with st.expander("ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆâ‘£ã€å€‹åˆ¥ã®æŒ‡å°è¨ˆç”»ï¼šç›®æ¨™ã¨æ‰‹ç«‹ã¦ã€‘"):
    with st.container(border=True):
        st.subheader("ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆâ‘£ã€å€‹åˆ¥ã®æŒ‡å°è¨ˆç”»ï¼šç›®æ¨™ã¨æ‰‹ç«‹ã¦ã€‘")
        st.write("å€‹åˆ¥ã®æŒ‡å°è¨ˆç”»ã®ç›®æ¨™ã¨å…·ä½“çš„ãªæ‰‹ç«‹ã¦ã‚’ã€é¸æŠã•ã‚ŒãŸæ•™ç§‘ã”ã¨ã«ç”Ÿæˆã—ã¾ã™ã€‚")

        # æ•™ç§‘ã®é¸æŠ
        subject_options = [
            "è‡ªç«‹æ´»å‹•","æ—¥å¸¸ç”Ÿæ´»ã®æŒ‡å°","è·æ¥­","ç”Ÿæ´»å˜å…ƒå­¦ç¿’","ä½œæ¥­å­¦ç¿’","å›½èª", "ç®—æ•°", "ç¾è¡“", "ç†ç§‘", "ç¤¾ä¼š", "éŸ³æ¥½", "å›³ç”»å·¥ä½œ", "ä½“è‚²", "å®¶åº­", 
            "å¤–å›½èªæ´»å‹•", "ç·åˆçš„ãªå­¦ç¿’ã®æ™‚é–“", "è‡ªç«‹æ´»å‹•", "æ—¥å¸¸ç”Ÿæ´»ã®æŒ‡å°","ä¿é™º","æ•°å­¦"
        ]
        selected_subjects = st.multiselect("âœ… ç›®æ¨™ã¨æ‰‹ç«‹ã¦ã‚’ä½œæˆã™ã‚‹æ•™ç§‘ã‚’é¸æŠï¼ˆè¤‡æ•°é¸æŠå¯ï¼‰", subject_options, key="selected_subjects_4")

        # å®Ÿæ…‹ã‚„èª²é¡Œã®å…¥åŠ›ï¼ˆå„æ•™ç§‘ç”¨ï¼‰
        jittai_inputs_4 = {}
        st.markdown("---")
        st.subheader("ğŸ’¡ å„æ•™ç§‘ã®å®Ÿæ…‹ã‚„èª²é¡Œã‚’å…¥åŠ›ã—ã¦ãã ã•ã„")
        for subject in selected_subjects:
            jittai_inputs_4[subject] = st.text_area(f"âœ… ã€{subject}ã€‘ã«é–¢ã™ã‚‹å†…å®¹ã€ãŠå­ã•ã‚“ã®å®Ÿæ…‹ã‚„èª²é¡Œã‚’å…¥åŠ›",
                                                      value="ï¼ˆä¾‹ï¼šãƒŸãƒ‹ãƒˆãƒãƒˆã®æ¤ç”Ÿã‚’è¡Œã£ãŸï¼ˆç¨®ä¸Šãƒ»è¦³å¯Ÿãƒ»è¨˜éŒ²ãƒ»åç©«ãƒ»èª¿ç†ï¼‰",
                                                      height=100, key=f"jittai_4_{subject}")

        # æŒ‡å°æ–¹é‡ã®å…¥åŠ›ï¼ˆå‚è€ƒæƒ…å ±ã¨ã—ã¦ï¼‰
        shido_hoshin_4 = st.text_area("âœ… å®Ÿæ…‹ã‚„èª²é¡Œ",
                                      value="ï¼ˆä¾‹ï¼šæ–‡å­—ã‚’èª­ã‚€ã“ã¨ã«æŠµæŠ—ãŒã‚ã‚‹ã€æ•°ã®æ¦‚å¿µãŒç†è§£ã—ã¥ã‚‰ã„ã€è½ã¡ç€ã„ã¦åº§ã£ã¦ã„ã‚‰ã‚Œãªã„ã€å‹é”ã¨ã®ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒè‹¦æ‰‹ãªã©ï¼‰ã€ä¸é©åˆ‡è¡Œå‹•ãŒèµ·ããŸæ™‚ã«ç¹°ã‚Šè¿”ã•ãªã„ã‚ˆã†ã«ã™ã‚‹ã€‚çµµã‚«ãƒ¼ãƒ‰ã‚„æ‰‹è©±ã«ã‚ˆã‚‹è¦æ±‚ã‚’å¢—ã‚„ã™ã€‚ãªã©ï¼‰",
                                      height=100, key="shido_hoshin_4_global")

        if st.button("ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆâ‘£ ã‚’ç”Ÿæˆ", key="btn_4", use_container_width=True):
            full_prompt_output = []
            for subject in selected_subjects:
                num_items = 3 if subject in ["è‡ªç«‹æ´»å‹•", "æ—¥å¸¸ç”Ÿæ´»ã®æŒ‡å°"] else 2
                current_jittai = jittai_inputs_4.get(subject, "")

                prompt_for_subject = f"""
ä»¥ä¸‹ã®æƒ…å ±ã‚’ã‚‚ã¨ã«ã€å€‹åˆ¥ã®æŒ‡å°è¨ˆç”»ã«ãŠã‘ã‚‹ã€{subject}ã€‘ã®ç›®æ¨™ã¨æ‰‹ç«‹ã¦ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚

ã€å…¥åŠ›ã€‘
æ•™ç§‘ï¼š{subject}
æ•™ç§‘ã®å†…å®¹ï¼š{current_jittai}
å‚è€ƒæŒ‡å°æ–¹é‡ï¼š{shido_hoshin_4}

ã€å‡ºåŠ›é …ç›®ã€‘
1. ç›®æ¨™ï¼ˆ{num_items}ã¤ï¼‰ï¼š
   ãƒ»å„ç›®æ¨™ã¯30å­—ä»¥å†…ç¨‹åº¦ã§ã€ãŠå­ã•ã‚“ãŒé”æˆã™ã¹ãå…·ä½“çš„ãªè¡Œå‹•ã‚„çŠ¶æ…‹ã‚’ç¤ºã™ã“ã¨ã€‚
   ãƒ»æ•™è‚²çš„ã§æŸ”ã‚‰ã‹ã„è¡¨ç¾ã«ã™ã‚‹ã“ã¨ã€‚

2. æ‰‹ç«‹ã¦ï¼ˆ{num_items}ã¤ï¼‰ï¼š
   ãƒ»å„æ‰‹ç«‹ã¦ã¯30å­—ã‹ã‚‰50å­—ç¨‹åº¦ã§ã€ç›®æ¨™é”æˆã®ãŸã‚ã«å­¦æ ¡ç¾å ´ã§å®Ÿè·µå¯èƒ½ãªå…·ä½“çš„ãªæ”¯æ´å†…å®¹ã‚„æ–¹æ³•ã‚’ç¤ºã™ã“ã¨ã€‚
   ãƒ»ãŠå­ã•ã‚“ã®å®Ÿæ…‹ã‚„èª²é¡Œã€æŒ‡å°æ–¹é‡ã‚’è€ƒæ…®ã—ã€å€‹åˆ¥å…·ä½“çš„ãªå†…å®¹ã«ã™ã‚‹ã“ã¨ã€‚

ã€å‡ºåŠ›ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆä¾‹ã€‘
ã€{subject}ã€‘
ç›®æ¨™ï¼š
ãƒ»ï¼ˆç›®æ¨™1ï¼š30å­—ä»¥å†…ï¼‰
ãƒ»ï¼ˆç›®æ¨™2ï¼š30å­—ä»¥å†…ï¼‰
{"ãƒ»ï¼ˆç›®æ¨™3ï¼š30å­—ä»¥å†…ï¼‰" if num_items == 3 else ""}

æ‰‹ç«‹ã¦ï¼š
ãƒ»ï¼ˆæ‰‹ç«‹ã¦1ï¼š30ï½50å­—ï¼‰
ãƒ»ï¼ˆæ‰‹ç«‹ã¦2ï¼š30ï½50å­—ï¼‰
{"ãƒ»ï¼ˆæ‰‹ç«‹ã¦3ï¼š30ï½50å­—ï¼‰" if num_items == 3 else ""}

ã€æ¡ä»¶ã€‘ï¼š
- ã€Œï½ã§ã™ã€‚ï½ã¾ã™ã€‚ã€èª¿ã§ã¯ãªãã€ã€Œï½ã§ã‚ã‚‹ã€‚ã€èª¿ã§çµ±ä¸€ã—ã¦ãã ã•ã„ã€‚
- æ·»ä»˜è³‡æ–™ï¼ˆå€‹åˆ¥ã®æŒ‡å°è¨ˆç”»ãªã©ï¼‰ãŒã‚ã‚‹å ´åˆã¯ã€ãã®æ›¸ãæ–¹ã‚’å‚è€ƒã«ã—ã¦ãã ã•ã„ã€‚
- ä»–ã®æ•™ç§‘ã®ç›®æ¨™ã‚„æ‰‹ç«‹ã¦ã¯å‡ºåŠ›ã›ãšã€æŒ‡å®šã•ã‚ŒãŸã€{subject}ã€‘ã®ã¿ã‚’å‡ºåŠ›ã—ã¦ãã ã•ã„ã€‚
- ç›®æ¨™ã¨æ‰‹ç«‹ã¦ã®æ•°ã¯ã€è‡ªç«‹æ´»å‹•ã¨æ—¥å¸¸ç”Ÿæ´»ã®æŒ‡å°ã¯3ã¤ä»¥ä¸Šã€ãã‚Œä»¥å¤–ã¯2ã¤ã¨ã—ã¦ãã ã•ã„ã€‚
- ç›®æ¨™ã¨æ‰‹ç«‹ã¦ã®å†…å®¹ã¯ã€å…¥åŠ›ã•ã‚ŒãŸå®Ÿæ…‹ã‚„èª²é¡Œã€å‚è€ƒæŒ‡å°æ–¹é‡ã¨é€£å‹•ã•ã›ã¦å…·ä½“çš„ã«è¨˜è¿°ã—ã¦ãã ã•ã„ã€‚
"""
                full_prompt_output.append(prompt_for_subject)

            st.subheader("ğŸ“„ ç”Ÿæˆã•ã‚ŒãŸãƒ—ãƒ­ãƒ³ãƒ—ãƒˆâ‘£ï¼ˆã‚³ãƒ”ãƒ¼ã—ã¦ä½¿ã£ã¦ãã ã•ã„ï¼‰")
            if not full_prompt_output:
                st.warning("æ•™ç§‘ãŒé¸æŠã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚")
            else:
                st.code("\n---\n".join(full_prompt_output), language="text") # å„æ•™ç§‘ã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’åŒºåˆ‡ã‚Šç·šã§çµåˆã—ã¦è¡¨ç¤º

# --- ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆâ‘¤ ---
with st.expander("ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆâ‘¤ã€å€‹åˆ¥ã®æŒ‡å°è¨ˆç”»ï¼šè©•ä¾¡ã€‘"):
    with st.container(border=True):
        st.subheader("ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆâ‘¤ã€å€‹åˆ¥ã®æŒ‡å°è¨ˆç”»ï¼šè©•ä¾¡ã€‘")
        st.write("æŒ‡å°è¨ˆç”»ã‚’åŸºã«ã€æ´»å‹•ã®æ§˜å­ã‚’è©•ä¾¡ã™ã‚‹æ–‡ç« ã‚’ä½œæˆã—ã¾ã™ã€‚")

        use_file_4 = st.checkbox(
            "AIã«Word/Excelç­‰ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ·»ä»˜ã—ã¦ã€ä¸»ãŸã‚‹æƒ…å ±æºã¨ã—ã¦åˆ©ç”¨ã™ã‚‹", 
            key="use_file_4"
        )
        st.caption("ğŸ’¡ ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ·»ä»˜ã™ã‚‹å ´åˆã€ä¸‹ã®ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢ã¯è£œè¶³ã¨ã—ã¦åˆ©ç”¨ã§ãã¾ã™ã€‚")

        reference_text_4 = st.text_area(
            "âœ… å‚è€ƒã«ã™ã‚‹æŒ‡å°è¨ˆç”»ã®ãƒ†ã‚­ã‚¹ãƒˆï¼ˆè£œè¶³ãªã©ï¼‰",
            value="ï¼ˆä¾‹ï¼šå€‹åˆ¥ã®æŒ‡å°è¨ˆç”»ã®ã€ŒæŒ‡å°ã®ç›®æ¨™ãŠã‚ˆã³å†…å®¹ã€ã®å…¨æ–‡ã‚„ã€ç‰¹ã«è¦‹ã¦ã»ã—ã„éƒ¨åˆ†ãªã©ï¼‰",
            height=150,
            key="reference_4"
        )
        
        evaluation_activities_4 = st.text_area(
            "âœ… æ•™ç§‘ã”ã¨ã®ã€Œã§ããŸã“ã¨ãƒ»æ´»å‹•ã®æ§˜å­ã€ã‚’å…·ä½“çš„ã«å…¥åŠ›",
            value="ã€è‡ªç«‹æ´»å‹•ã€‘ï¼šãƒ»æ•™å“¡ã®èª˜å°ã§è‚©ã‚„é¦–ã®åŠ›ã‚’æŠœãã€èƒ¸ã‚’å¼µã£ãŸå§¿å‹¢ã§æ´»å‹•ã§ããŸã€‚ãƒ»ç‰‡æ‰‹ã§æ”¯ãˆãªãŒã‚‰ç‰‡è¶³ç«‹ã¡ãŒã§ããŸã€‚\nã€å›½èªã€‘ï¼šè‡ªåˆ†ã®åå‰ã‚’ä¸å¯§ã«ãªãã‚Šæ›¸ãã§ããŸã€‚",
            height=150,
            key="evaluation_activities_4"
        )

        if st.button("ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆâ‘¤ ã‚’ç”Ÿæˆ", key="btn_5", use_container_width=True):
            prompt_intro_4 = ""
            prompt_main_source_4 = ""

            if use_file_4:
                prompt_intro_4 = "æ·»ä»˜ã—ãŸæŒ‡å°è¨ˆç”»ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¸»ãŸã‚‹æƒ…å ±æºã¨ã—ã€"
                if reference_text_4.strip() and reference_text_4 != "ï¼ˆä¾‹ï¼šå€‹åˆ¥ã®æŒ‡å°è¨ˆç”»ã®ã€ŒæŒ‡å°ã®ç›®æ¨™ãŠã‚ˆã³å†…å®¹ã€ã®å…¨æ–‡ã‚„ã€ç‰¹ã«è¦‹ã¦ã»ã—ã„éƒ¨åˆ†ãªã©ï¼‰":
                    prompt_main_source_4 = f"ä»¥ä¸‹ã®ã€å‚è€ƒãƒ†ã‚­ã‚¹ãƒˆã€‘ã‚‚è£œè¶³æƒ…å ±ã¨ã—ã¦è€ƒæ…®ã—ãŸä¸Šã§ã€"
                else:
                     prompt_main_source_4 = "ä»¥ä¸‹ã®"

            else:
                prompt_intro_4 = "ä»¥ä¸‹ã®ã€æŒ‡å°è¨ˆç”»ã®ãƒ†ã‚­ã‚¹ãƒˆã€‘ã‚’ä¸»ãŸã‚‹æƒ…å ±æºã¨ã—ã¦ã€"
            
            prompt_text_part_4 = f"""ã€æŒ‡å°è¨ˆç”»ã®ãƒ†ã‚­ã‚¹ãƒˆã€‘ï¼š
{reference_text_4}
""" if not use_file_4 or (use_file_4 and reference_text_4.strip() and reference_text_4 != "ï¼ˆä¾‹ï¼šå€‹åˆ¥ã®æŒ‡å°è¨ˆç”»ã®ã€ŒæŒ‡å°ã®ç›®æ¨™ãŠã‚ˆã³å†…å®¹ã€ã®å…¨æ–‡ã‚„ã€ç‰¹ã«è¦‹ã¦ã»ã—ã„éƒ¨åˆ†ãªã©ï¼‰") else ""


            prompt_full_4 = f"""{prompt_intro_4}{prompt_main_source_4}ã€ã§ããŸã“ã¨ãƒ»æ´»å‹•ã®æ§˜å­ã€‘ã¨ã‚’é–¢é€£ä»˜ã‘ãªãŒã‚‰ã€æ•™ç§‘ã”ã¨ã®ã€Œå€‹åˆ¥ã®æŒ‡å°ã®è©•ä¾¡ã€ï¼ˆæŒ¯ã‚Šè¿”ã‚Šæ–‡ï¼‰ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚
{prompt_text_part_4}
ã€ã§ããŸã“ã¨ãƒ»æ´»å‹•ã®æ§˜å­ã€‘ï¼š
{evaluation_activities_4}

ã€å‡ºåŠ›ãƒ«ãƒ¼ãƒ«ã€‘ï¼š
- ã¾ãšã€ä¸»ãŸã‚‹æƒ…å ±æºï¼ˆæ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«ã¾ãŸã¯ä¸Šè¨˜ãƒ†ã‚­ã‚¹ãƒˆï¼‰ã‚’èª­ã¿è¾¼ã¿ã€ãã“ã«æ›¸ã‹ã‚Œã¦ã„ã‚‹ç›®æ¨™ã‚„å†…å®¹ã‚’å®Œå…¨ã«ç†è§£ã—ã¦ãã ã•ã„ã€‚
- ã€Œï½ã§ã™ã€‚ï½ã¾ã™ã€‚ã€èª¿ã§ã¯ãªãã€ã€Œï½ã§ã‚ã‚‹ã€‚ã€èª¿ã§æ–‡ç« ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚
- ãã®ä¸Šã§ã€ã€ã§ããŸã“ã¨ãƒ»æ´»å‹•ã®æ§˜å­ã€‘ãŒã€è¨ˆç”»ã®ã©ã®ç›®æ¨™ãƒ»å†…å®¹ã«å¯¾å¿œã™ã‚‹ã®ã‹ã‚’åˆ†æã—ã€ç›®æ¨™ã®é”æˆåº¦åˆã„ãŒåˆ†ã‹ã‚‹ã‚ˆã†ã«è©•ä¾¡æ–‡ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚
- è¨ˆç”»ã§è¨€åŠã•ã‚Œã¦ã„ã‚‹ã™ã¹ã¦ã®æ•™ç§‘ãƒ»é ˜åŸŸã«ã¤ã„ã¦ã€è©•ä¾¡æ–‡ã‚’å€‹åˆ¥ã«å‡ºåŠ›ã—ã¦ãã ã•ã„ã€‚
- å„æ•™ç§‘ã«ã¤ã„ã¦ã€ã€æ•™ç§‘åã®è¦‹å‡ºã—ã€‘ã¨200ï½300æ–‡å­—ç¨‹åº¦ã®è©•ä¾¡æ–‡ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚
- æ–‡ä½“ã¯ã€å®Ÿå‹™ã§ä½¿ç”¨ã•ã‚Œã‚‹ã‚ˆã†ãªæŸ”ã‚‰ã‹ãæ•™è‚²çš„ãªè¡¨ç¾ã«ã—ã¦ãã ã•ã„ã€‚"""

            st.subheader("ğŸ“„ ç”Ÿæˆã•ã‚ŒãŸãƒ—ãƒ­ãƒ³ãƒ—ãƒˆâ‘¤ï¼ˆã‚³ãƒ”ãƒ¼ã—ã¦ä½¿ã£ã¦ãã ã•ã„ï¼‰")
            st.code(prompt_full_4, language="text")


# --- ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆâ‘¥ ---
with st.expander("ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆâ‘¥ã€å‰æœŸãƒ»å¾ŒæœŸã®æ‰€è¦‹ã€‘"):
    with st.container(border=True):
        st.subheader("ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆâ‘¥ã€å‰æœŸãƒ»å¾ŒæœŸã®æ‰€è¦‹ã€‘")
        st.write("è©•ä¾¡æ–‡ã‚„è¨ˆç”»æ›¸ã‚’åŸºã«ã€ç·åˆçš„ãªæ‰€è¦‹ã‚’ä½œæˆã—ã¾ã™ã€‚")

        term_choice = st.radio("ã©ã¡ã‚‰ã®æ‰€è¦‹ã‚’ä½œæˆã—ã¾ã™ã‹ï¼Ÿ", ("å‰æœŸ", "å¾ŒæœŸï¼å­¦å¹´æœ«"), key="term_choice", horizontal=True)

        use_file_5 = st.checkbox(
            "AIã«è©•ä¾¡æ–‡ç­‰ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ·»ä»˜ã—ã¦ã€ä¸»ãŸã‚‹æƒ…å ±æºã¨ã—ã¦åˆ©ç”¨ã™ã‚‹",
            key="use_file_5"
        )
        st.caption("ğŸ’¡ ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ·»ä»˜ã™ã‚‹å ´åˆã€ä¸‹ã®ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢ã¯è£œè¶³ã¨ã—ã¦åˆ©ç”¨ã§ãã¾ã™ã€‚")

        reference_text_5 = st.text_area(
            "âœ… å‚è€ƒã«ã™ã‚‹è©•ä¾¡æ–‡ã‚„è¨ˆç”»ã®ãƒ†ã‚­ã‚¹ãƒˆï¼ˆè£œè¶³ãªã©ï¼‰",
            value="ï¼ˆä¾‹ï¼šãƒ—ãƒ­ãƒ³ãƒ—ãƒˆâ‘£ã§ä½œæˆã—ãŸè©•ä¾¡æ–‡ã®å…¨ä½“ã€ã¾ãŸã¯ç‰¹ã«è¦‹ã¦ã»ã—ã„éƒ¨åˆ†ãªã©ï¼‰",
            height=200,
            key="reference_5"
        )
        
        shoken_input = st.text_area(
            "âœ… æ‰€è¦‹ã§ç‰¹ã«å¼·èª¿ã—ãŸã„ãƒã‚¤ãƒ³ãƒˆã‚’å…¥åŠ›ï¼ˆç®‡æ¡æ›¸ãã§OKï¼‰",
            value="- å¤§ããªã‘ãŒã‚‚ãªãå…ƒæ°—ã«ç™»æ ¡ã§ããŸã“ã¨ã®å–œã³ã€‚\n- å‹äººã¨ã®é–¢ã‚ã‚ŠãŒå‰å‘ãã«ãªã£ãŸç‚¹ã€‚\n- å®¿æ³Šå­¦ç¿’ãªã©ã®å¤§ããªè¡Œäº‹ã‚’ä¹—ã‚Šè¶ŠãˆãŸè‡ªä¿¡ã€‚\n- å®¶åº­ã¨ã®é€£æºã¸ã®æ„Ÿè¬ã€‚",
            height=150,
            key="shoken_input"
        )

        if st.button("ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆâ‘¥ ã‚’ç”Ÿæˆ", key="btn_6", use_container_width=True):
            prompt_intro_5 = ""
            prompt_main_source_5 = ""

            if use_file_5:
                prompt_intro_5 = "æ·»ä»˜ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆè©•ä¾¡æ–‡ã‚„è¨ˆç”»æ›¸ãªã©ï¼‰ã‚’ä¸»ãŸã‚‹æƒ…å ±æºã¨ã—ã€"
                if reference_text_5.strip() and reference_text_5 != "ï¼ˆä¾‹ï¼šãƒ—ãƒ­ãƒ³ãƒ—ãƒˆâ‘£ã§ä½œæˆã—ãŸè©•ä¾¡æ–‡ã®å…¨ä½“ã€ã¾ãŸã¯ç‰¹ã«è¦‹ã¦ã»ã—ã„éƒ¨åˆ†ãªã©ï¼‰":
                    prompt_main_source_5 = "ä»¥ä¸‹ã®ã€å‚è€ƒãƒ†ã‚­ã‚¹ãƒˆã€‘ã‚‚è£œè¶³æƒ…å ±ã¨ã—ã¦è€ƒæ…®ã—ã€"
                else:
                    prompt_main_source_5 = ""
            else:
                prompt_intro_5 = "ä»¥ä¸‹ã®ã€å‚è€ƒãƒ†ã‚­ã‚¹ãƒˆã€‘ã‚’ä¸»ãŸã‚‹æƒ…å ±æºã¨ã—ã¦ã€"

            prompt_text_part_5 = f"""ã€å‚è€ƒãƒ†ã‚­ã‚¹ãƒˆã€‘ï¼š
{reference_text_5}
""" if not use_file_5 or (use_file_5 and reference_text_5.strip() and reference_text_5 != "ï¼ˆä¾‹ï¼šãƒ—ãƒ­ãƒ³ãƒ—ãƒˆâ‘£ã§ä½œæˆã—ãŸè©•ä¾¡æ–‡ã®å…¨ä½“ã€ã¾ãŸã¯ç‰¹ã«è¦‹ã¦ã»ã—ã„éƒ¨åˆ†ãªã©ï¼‰") else ""

            if term_choice == "å‰æœŸ":
                specific_conditions = """- ã€Œå‰æœŸã¯ã€ã€œã€ã¨ã„ã£ãŸæ›¸ãå‡ºã—ã§å§‹ã‚ã¦ãã ã•ã„ã€‚
- 200ï½400æ–‡å­—ç¨‹åº¦ã®æ–‡ç« é‡ã§ä½œæˆã—ã¦ãã ã•ã„ã€‚
- æ–‡æœ«ã«ã¯ã€Œå¾ŒæœŸã‚‚å¼•ãç¶šãã€ã”å®¶åº­ã¨é€£æºã‚’å–ã‚ŠãªãŒã‚‰ã€æˆé•·ã‚’è¦‹å®ˆã£ã¦ã„ããŸã„ã¨æ€ã„ã¾ã™ã€‚ã‚ˆã‚ã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ã€ãªã©ã€å¾ŒæœŸã¸ã®é€£æºã‚’æ„è­˜ã—ãŸä¸€æ–‡ã‚’å…¥ã‚Œã¦ãã ã•ã„ã€‚"""
            else: # å¾ŒæœŸï¼å­¦å¹´æœ«
                specific_conditions = """- ã€Œã“ã®1å¹´é–“ã§ã€œã€ã‚„ã€Œã„ã‚ˆã„ã‚ˆæ¥å¹´åº¦ã¯ã€œã€ãªã©ã€å¹´åº¦ã®åŒºåˆ‡ã‚Šã‚’æ„Ÿã˜ã•ã›ã‚‹æ›¸ãå‡ºã—ã«ã—ã¦ãã ã•ã„ã€‚
- 200ã€œ450æ–‡å­—ç¨‹åº¦ã®æ–‡ç« é‡ã§ä½œæˆã—ã¦ãã ã•ã„ã€‚
- æ–‡æœ«ã«ã¯ã€ä¿è­·è€…ã¸ã®æ„Ÿè¬ã¨ã€æ¬¡å¹´åº¦ã«å‘ã‘ãŸå¿œæ´ã®è¨€è‘‰ã‚’å¿…ãšå«ã‚ã¦ãã ã•ã„ã€‚"""

            prompt_full_5 = f"""{prompt_intro_5}{prompt_main_source_5}ã•ã‚‰ã«ã€å¼·èª¿ã—ãŸã„ãƒã‚¤ãƒ³ãƒˆã€‘ã‚’ç››ã‚Šè¾¼ã¿ãªãŒã‚‰ã€ä¿è­·è€…å‘ã‘ã®ã€Œ{term_choice}ã®æ‰€è¦‹ã€ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚
{prompt_text_part_5}
ã€å¼·èª¿ã—ãŸã„ãƒã‚¤ãƒ³ãƒˆã€‘ï¼š
{shoken_input}

ã€å…¨ä½“ã®å…±é€šæ¡ä»¶ã€‘ï¼š
- ä¸»ãŸã‚‹æƒ…å ±æºï¼ˆæ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«ã¾ãŸã¯ä¸Šè¨˜ãƒ†ã‚­ã‚¹ãƒˆï¼‰ã‹ã‚‰å…¨ä½“çš„ãªæˆé•·ã®æ§˜å­ã‚’èª­ã¿å–ã‚Šã€ã€å¼·èª¿ã—ãŸã„ãƒã‚¤ãƒ³ãƒˆã€‘ã‚’ç‰¹ã«æ„è­˜ã—ã¦ã€è‡ªç„¶ãªæ–‡ç« ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚
- æ·»ä»˜è³‡æ–™å†…ã«å…·ä½“çš„äº‹è±¡ï¼ˆä¾‹ï¼šå¤§ããªè¡Œäº‹ã®é”æˆã€å‹äººã¨ã®ã‚„ã‚Šã¨ã‚Šã€ã‘ãŒã®æœ‰ç„¡ï¼‰ãŒã‚ã‚‹å ´åˆã¯å…·ä½“ä¾‹ã‚’1ã¤ä»¥ä¸ŠæŒ™ã’ã¦æ‰€è¦‹ã«åæ˜ ã™ã‚‹ã“ã¨ã€‚
- ä¸å¯§ãªèªã‚Šå£ã§ã€å‰å‘ããªè¡¨ç¾ã‚’å¿ƒãŒã‘ã¦ãã ã•ã„ã€‚
- ä¿è­·è€…ã®æ–¹ãŒèª­ã‚“ã§ã€ãŠå­ã•ã‚“ã®å…·ä½“çš„ãªæˆé•·ãŒä¼ã‚ã‚‹ã‚ˆã†ãªæ–‡ç« ã«ã—ã¦ãã ã•ã„ã€‚
- ã€Œï½ã§ã™ã€‚ï½ã¾ã™ã€‚ã€èª¿ã§ã¯ãªãã€ã€Œï½ã§ã‚ã‚‹ã€‚ã€èª¿ã§æ–‡ç« ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚
- ã‚‚ã—ã€å…¥åŠ›ã€‘ã‚„æ·»ä»˜è³‡æ–™ã®å†…å®¹ãŒæ¥µç«¯ã«çŸ­ã„ãƒ»æƒ…å ±ä¸è¶³ãªå ´åˆã¯ã€å‰æœŸã¯200å­—ã€å¾ŒæœŸã¯200å­—ã‚’ä¸‹å›ã‚‰ãªã„ã‚ˆã†ã«ã€å®Ÿå‹™çš„ã«å¦¥å½“ãªè¨˜è¿°ã‚’å‚è€ƒãƒ†ã‚­ã‚¹ãƒˆã«åŸºã¥ãæ¨æ¸¬ã—ã¦è£œå®Œã™ã‚‹ã“ã¨

ã€{term_choice}ç”¨ã®å€‹åˆ¥æ¡ä»¶ã€‘ï¼š
{specific_conditions}"""

            st.subheader(f"ğŸ“„ ç”Ÿæˆã•ã‚ŒãŸãƒ—ãƒ­ãƒ³ãƒ—ãƒˆâ‘¥ï¼ˆ{term_choice}ã®æ‰€è¦‹ç”¨ï¼‰")
            st.code(prompt_full_5, language="text")

st.markdown("---")

# --- ã€Œå²©æ§»ã¯ã‚‹ã‹ãœç‰¹åˆ¥æ”¯æ´å­¦æ ¡ã®äººã€ãƒœã‚¿ãƒ³ã¨æ©Ÿèƒ½è¿½åŠ  ---
st.header("âœ¨ ç‰¹åˆ¥æ”¯æ´å­¦æ ¡å‘ã‘æ©Ÿèƒ½")
if st.button("å²©æ§»ã¯ã‚‹ã‹ãœç‰¹åˆ¥æ”¯æ´å­¦æ ¡ã®äººå‘ã‘ã€ãƒšãƒ¼ã‚¹ãƒˆã•ã‚ŒãŸå†…å®¹ã‚’åŸºã«ãƒ—ãƒ©ãƒ³ï¼ˆExcelï¼‰ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ãã¾ã™", use_container_width=True, type="secondary"):
    st.session_state["show_iwatsuki_features"] = not st.session_state.get("show_iwatsuki_features", False)

if st.session_state.get("show_iwatsuki_features", False):
    st.subheader("AIã®å‡ºåŠ›ã‚’Excelã«è²¼ã‚Šä»˜ã‘")
    st.info("AIã®å‡ºåŠ›å†…å®¹ã‚’ä»¥ä¸‹ã®ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢ã«è²¼ã‚Šä»˜ã‘ã€å¯¾å¿œã™ã‚‹ã‚·ãƒ¼ãƒˆã¨ã‚»ãƒ«ã‚’æŒ‡å®šã—ã¦Excelãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ãã ã•ã„ã€‚")

    # Excelã‚·ãƒ¼ãƒˆã¨ã‚»ãƒ«æƒ…å ±ã®å®šç¾©
    excel_mappings = {
        "ãƒ—ãƒ©ãƒ³ï¼¡": {
            "ç‰¹åˆ¥ãªæ•™è‚²çš„ãƒ‹ãƒ¼ã‚º": "D12",
            "åˆç†çš„é…æ…®ã®å®Ÿæ–½å†…å®¹": "D15",
            "ç›®æ¨™ãƒ»æ©Ÿé–¢å": "D18",
            "æ”¯æ´å†…å®¹": "E18"
        },
        "ãƒ—ãƒ©ãƒ³ï¼¢(å®Ÿæ…‹)": {
            "æŒ‡å°æ–¹é‡": "C5",
            "1å¥åº·ã®ä¿æŒ": "D8",
            "2å¿ƒç†çš„ãªå®‰å®š": "D10",
            "3äººé–“é–¢ä¿‚ã®å½¢æˆ": "D12",
            "4ç’°å¢ƒã®æŠŠæ¡": "D14",
            "5èº«ä½“ã®å‹•ã": "D16",
            "6ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³": "D18",
            "7ãã®ä»–": "D20",
        }
    }

    # å„é …ç›®ã¨å¯¾å¿œã™ã‚‹ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢ã€ã‚·ãƒ¼ãƒˆã€ã‚»ãƒ«
    ai_output_inputs = {}
    for sheet_name, cells in excel_mappings.items():
        st.markdown(f"#### ã‚·ãƒ¼ãƒˆ: {sheet_name}")
        for label, cell_address in cells.items():
            key = f"{sheet_name}_{label}"
            ai_output_inputs[key] = st.text_area(f"ã€Œ{label}ã€ã®å†…å®¹ã‚’ã“ã“ã«è²¼ã‚Šä»˜ã‘ï¼ˆã‚»ãƒ«: {cell_address}ï¼‰", key=key, height=150)

    if st.button("Excelã«æ›¸ãå‡ºã—ã¦ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰", type="primary", use_container_width=True):
        try:
            # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¨åŒã˜éšå±¤ã«ã‚ã‚‹ãƒ—ãƒ©ãƒ³.xlsxã‚’èª­ã¿è¾¼ã‚€
            # st.cache_dataã‚„st.cache_resourceã¯ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿ã«ã¯é©ã•ãªã„ãŸã‚ã€ç›´æ¥èª­ã¿è¾¼ã‚€
            workbook = load_workbook("ãƒ—ãƒ©ãƒ³.xlsx")
            
            # å„ã‚·ãƒ¼ãƒˆã«ãƒ‡ãƒ¼ã‚¿ã‚’æ›¸ãè¾¼ã‚€
            for sheet_name, cells in excel_mappings.items():
                if sheet_name in workbook.sheetnames:
                    sheet = workbook[sheet_name]
                    for label, cell_address in cells.items():
                        key = f"{sheet_name}_{label}"
                        content = ai_output_inputs.get(key, "")
                        
                        # ã‚»ãƒ«ã«å†…å®¹ã‚’æ›¸ãè¾¼ã¿
                        sheet[cell_address] = content
                        
                        # çµåˆã‚»ãƒ«ã«å¯¾å¿œï¼ˆD12~H12ãªã©ï¼‰
                        if sheet_name == "ãƒ—ãƒ©ãƒ³ï¼¡":
                            if label == "ç‰¹åˆ¥ãªæ•™è‚²çš„ãƒ‹ãƒ¼ã‚º":
                                sheet.merge_cells('D12:H12')
                                sheet['D12'].alignment = Alignment(wrap_text=True, vertical='top')
                            elif label == "åˆç†çš„é…æ…®ã®å®Ÿæ–½å†…å®¹":
                                sheet.merge_cells('D15:H15')
                                sheet['D15'].alignment = Alignment(wrap_text=True, vertical='top')
                            elif label == "æ”¯æ´å†…å®¹": # E18ã¯F18ã¨çµåˆ
                                sheet.merge_cells('E18:F18')
                                sheet['E18'].alignment = Alignment(wrap_text=True, vertical='top')
                        elif sheet_name == "ãƒ—ãƒ©ãƒ³ï¼¢(å®Ÿæ…‹)":
                            if label == "æŒ‡å°æ–¹é‡":
                                sheet.merge_cells('C5:F5')
                                sheet['C5'].alignment = Alignment(wrap_text=True, vertical='top')
                            elif label.startswith("1") or label.startswith("2") or label.startswith("3") or \
                                 label.startswith("4") or label.startswith("5") or label.startswith("6") or \
                                 label.startswith("7"):
                                # æŒ‡å°ã«çµã³ã¤ãå®Ÿæ…‹ã®Dåˆ—ã¯Fåˆ—ã¾ã§çµåˆ
                                # ä¾‹: "1å¥åº·ã®ä¿æŒ": "D8" -> D8:F8
                                col_start = cell_address[0] # D
                                row_num = cell_address[1:] # 8
                                sheet.merge_cells(f'{col_start}{row_num}:F{row_num}')
                                sheet[cell_address].alignment = Alignment(wrap_text=True, vertical='top')

                        # ãƒ†ã‚­ã‚¹ãƒˆã®æŠ˜ã‚Šè¿”ã—ã¨ä¸Šéƒ¨æƒãˆã‚’è¨­å®š (çµåˆã‚»ãƒ«ã‚‚è€ƒæ…®)
                        sheet[cell_address].alignment = Alignment(wrap_text=True, vertical='top')
                else:
                    st.warning(f"Excelãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚·ãƒ¼ãƒˆã€Œ{sheet_name}ã€ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚")

            # å¤‰æ›´ã‚’BytesIOã«ä¿å­˜ã—ã¦ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å¯èƒ½ã«ã™ã‚‹
            excel_file = BytesIO()
            workbook.save(excel_file)
            excel_file.seek(0) # ãƒ•ã‚¡ã‚¤ãƒ«ã®å…ˆé ­ã«æˆ»ã‚‹

            st.download_button(
                label="ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã€Œãƒ—ãƒ©ãƒ³.xlsxã€",
                data=excel_file,
                file_name="ãƒ—ãƒ©ãƒ³_æ›´æ–°ç‰ˆ.xlsx",
                mime="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",
                type="primary"
            )
            st.success("Excelãƒ•ã‚¡ã‚¤ãƒ«ãŒæ­£å¸¸ã«æ›´æ–°ã•ã‚Œã€ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰æº–å‚™ãŒã§ãã¾ã—ãŸï¼")

        except FileNotFoundError:
            st.error("ã‚¨ãƒ©ãƒ¼: 'ãƒ—ãƒ©ãƒ³.xlsx' ãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚WEBã‚¢ãƒ—ãƒªã¨åŒã˜éšå±¤ã«é…ç½®ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚")
        except Exception as e:
            st.error(f"Excelãƒ•ã‚¡ã‚¤ãƒ«ã®æ›¸ãè¾¼ã¿ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: {e}")

st.warning("""
**ã€åˆ©ç”¨ä¸Šã®æ³¨æ„ã€‘**
AIãŒç”Ÿæˆã™ã‚‹å†…å®¹ã¯ã€å…¥åŠ›ã•ã‚ŒãŸæƒ…å ±ã«åŸºã¥ãææ¡ˆã§ã‚ã‚Šã€å¿…ãšã—ã‚‚æ­£ç¢ºæ€§ã‚„é©åˆ‡æ€§ã‚’ä¿è¨¼ã™ã‚‹ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚è‡ªåˆ†ã®åˆ¤æ–­ã¨åˆã‚ã›ã¦ã”æ´»ç”¨ãã ã•ã„ã€‚
""")